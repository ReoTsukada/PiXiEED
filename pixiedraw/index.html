<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport"/>
<title>PiXiEEDraw（ピクシードロー） | リアルタイム共同編集・アニメ対応ドット絵エディター</title>
<meta content="#1f1f1f" name="theme-color"/>
<meta content="無料で使えるブラウザ版ドット絵エディター。リアルタイム共有モードでみんなで描ける。フレームアニメーション、オニオンスキン、レイヤー合成、GIF/PNG書き出しに対応。" name="description"/>
<meta content="PiXiEEDraw,ピクシードロー,ドット絵 エディター,ドット絵 描く サイト,ピクセルアート,リアルタイム 共同編集,アニメーション GIF,オニオンスキン" name="keywords"/>
<meta content="noindex,follow" name="robots"/>
<link rel="canonical" href="https://pixieed.jp/projects/pixiedraw/"/>
<meta content="website" property="og:type"/>
<meta content="PiXiEED" property="og:site_name"/>
<meta content="ja_JP" property="og:locale"/>
<meta content="PiXiEEDraw（ピクシードロー） | リアルタイム共同編集・アニメ対応" property="og:title"/>
<meta content="無料で使えるブラウザ版ドット絵エディター。リアルタイム共有モードでみんなで描ける。フレームアニメーション、オニオンスキン、レイヤー合成、GIF/PNG書き出しに対応。" property="og:description"/>
<meta content="https://pixieed.jp/pixiedraw/" property="og:url"/>
<meta content="https://pixieed.jp/pixiedraw/ogp-app.png" property="og:image"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@PiXiEED_arta" name="twitter:site"/>
<meta content="https://pixieed.jp/pixiedraw/" name="twitter:url"/>
<meta content="PiXiEEDraw（ピクシードロー） | リアルタイム共同編集・アニメ対応" name="twitter:title"/>
<meta content="無料で使えるブラウザ版ドット絵エディター。リアルタイム共有モードでみんなで描ける。フレームアニメーション、オニオンスキン、レイヤー合成、GIF/PNG書き出しに対応。" name="twitter:description"/>
<meta content="https://pixieed.jp/pixiedraw/ogp-app.png" name="twitter:image"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "PiXiEEDraw",
  "applicationCategory": "DesignApplication",
  "operatingSystem": "Web",
  "url": "https://pixieed.jp/pixiedraw/",
  "image": "https://pixieed.jp/pixiedraw/ogp-app.png",
  "description": "無料で使えるブラウザ版ドット絵エディター。リアルタイム共有モードでみんなで描ける。フレームアニメーション、オニオンスキン、レイヤー合成、GIF/PNG書き出しに対応。",
  "featureList": [
    "リアルタイム共有モード（マスター/参加者）",
    "フレームアニメーション編集（FPS設定）",
    "オニオンスキン表示",
    "レイヤー不透明度・合成モード",
    "GIF/PNG/プロジェクト書き出し",
    "PC/タブレット/スマホ対応"
  ],
  "softwareVersion": "2026.02",
  "dateModified": "2026-02-20",
  "isAccessibleForFree": true,
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "JPY"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PiXiEED",
    "url": "https://pixieed.jp/"
  }
}
</script>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9801602250480253"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SZPVXMX85G"></script>
<script>
      const GA_MEASUREMENT_ID = 'G-SZPVXMX85G';
      const GA_PAGE_PATH = '/pixiedraw/';
      const PROJECT_SLUG = 'pixiedraw';
      const PROJECT_NAME = 'PiXiEEDraw';
      const PROJECT_TYPE = 'tool';
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', GA_MEASUREMENT_ID, {
        page_path: GA_PAGE_PATH,
        page_title: document.title
      });
      gtag('event', 'project_open', {
        project_slug: PROJECT_SLUG,
        project_type: PROJECT_TYPE,
        project_name: PROJECT_NAME
      });
      gtag('event', 'project_open_pixiedraw');
    </script>



<link href="assets/css/style.css" rel="stylesheet"/>
<link rel="icon" type="image/png" sizes="192x192" href="../icon/icon-192-4.png"/>
<link rel="icon" type="image/png" sizes="512x512" href="../icon/icon-512-4.png"/>
  <style id="interaction-guard">
    * {
      -webkit-touch-callout: none;
      -webkit-user-drag: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    input,
    textarea,
    [contenteditable] {
      -webkit-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
  </style>
  <script id="interaction-guard-js">
    document.addEventListener('contextmenu', (event) => {
      event.preventDefault();
    });
    document.addEventListener('dragstart', (event) => {
      event.preventDefault();
    });
  </script>
<link rel="manifest" href="manifest.webmanifest"/>
<link rel="apple-touch-icon" href="/icon/icon-512-4.png"/>
</head>
<body>
<!-- Mobile ad placeholder: using bottom banner (mobileBottomAd) for PiXiEEDraw lite behavior -->
<div class="app" id="appRoot">
<div aria-labelledby="startupScreenTitle" aria-modal="true" class="startup-screen" hidden="" id="startupScreen" role="dialog" tabindex="-1">
<div class="startup-screen__backdrop"></div>
<div class="startup-screen__content">
<div class="startup-screen__header">
<h1 class="startup-screen__title" id="startupScreenTitle">PiXiEEDraw</h1>
<p class="startup-screen__subtitle">PiXiEEDraw（ピクシードロー）でドット絵づくりをはじめよう</p>
</div>
<div aria-label="起動操作" class="startup-screen__actions" role="group">
<button class="button button--primary" id="startupActionResume" type="button">前回の続きから再開</button>
<button class="button" id="startupActionNew" type="button">新規作成</button>
<button class="button" id="startupActionOpen" type="button">ファイルを開く</button>
</div>
<div class="startup-screen__hints">
<p class="startup-screen__hint" id="startupScreenHint">描画内容はこの端末に自動保存され、起動時に前回データを復元できます。</p>
<p class="startup-screen__hint" id="startupResumeHint">端末内プロジェクトを確認しています…</p>
</div>
<div class="startup-screen__recent" hidden="" id="startupRecentProjects">
<h2 class="startup-screen__recent-title">端末内プロジェクト（自動保存）</h2>
<div class="startup-recent-list" id="startupRecentList" role="list"></div>
</div>
<button class="startup-screen__link" id="startupActionSkip" type="button">この画面を閉じる</button>
</div>
</div>
<div aria-hidden="true" class="update-toast" data-update-id="2026-02-27-home-multi-export-i18n-input-updates" hidden="" id="updateToast" role="status" aria-live="polite">
<div class="update-toast__body">
<p class="update-toast__message">
<strong>更新情報 (2026/02/27)</strong><br/>
・PiXiEEDホーム導線を再整理（PiXiEEDraw / Lite の対比を明確化）<br/>
・常設ルーム運用を 256x256 の1部屋に統一、表示/入室UIを改善<br/>
・保存/出力からコンテスト投稿への遷移導線を追加、投稿形式を整理<br/>
・PiXiEEDrawに英語モードを追加し、レイヤー/マルチ文言の英訳を補完<br/>
・モバイル入力欄のキーボード被り対策と、サイズ入力Enter挙動を改善<br/>
・詳細は設定の「更新情報」から確認できます
</p>
<div class="update-toast__actions">
<button class="update-toast__btn update-toast__btn--primary" id="updateToastCloseBtn" type="button">閉じる</button>
</div>
</div>
</div>
<div class="mobile-topbar" hidden="" id="mobileTopBar">
<div class="mobile-topbar__inner">
<div aria-label="モバイル操作パネル" class="mobile-tabs" role="tablist">
<button aria-controls="mobilePanelTools" aria-label="ツール" aria-selected="true" class="mobile-tab is-active" data-mobile-tab="tools" id="mobileTabTools" role="tab" type="button">
<span class="tab-icon-container" id="mobileToolTabIcon"></span>
<span class="sr-only">ツール</span>
</button>
<button aria-controls="mobilePanelColor" aria-label="カラー" aria-selected="false" class="mobile-tab" data-mobile-tab="color" id="mobileTabColor" role="tab" tabindex="-1" type="button">
<span class="tab-swatch pixel-frame" id="mobileColorTabSwatch"></span>
<span class="sr-only">カラー</span>
</button>
<button aria-controls="mobilePanelFrames" aria-label="フレームとレイヤー" aria-selected="false" class="mobile-tab" data-mobile-tab="frames" id="mobileTabFrames" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-frame.png"/>
<span class="sr-only">フレームとレイヤー</span>
</button>
<button aria-controls="mobilePanelSettings" aria-label="設定" aria-selected="false" class="mobile-tab" data-mobile-tab="settings" id="mobileTabSettings" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-settings.svg"/>
<span class="sr-only">設定</span>
</button>
<button aria-controls="mobilePanelFile" aria-label="ファイル" aria-selected="false" class="mobile-tab" data-mobile-tab="file" id="mobileTabFile" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-file.svg"/>
<span class="sr-only">ファイル</span>
</button>
<button aria-controls="mobilePanelMulti" aria-label="共有モード" aria-selected="false" class="mobile-tab" data-mobile-tab="multi" id="mobileTabMulti" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/maltimode.svg"/>
<span class="sr-only">共有モード</span>
</button>
</div>
<div aria-label="モバイルショートカット" class="mobile-shortcuts" id="mobileShortcutsMount">
</div>
</div>
</div>
<div class="layout" id="appLayout">
<aside aria-label="ツールとカラー設定" class="rail rail--left" data-collapsed="false" data-compact="true" id="leftRail">
<div aria-label="左パネル切替" class="rail-tabs" id="leftRailTabs" role="tablist">
<button aria-controls="panelTools" aria-label="ツール" aria-selected="true" class="rail-tab is-active" data-left-tab="tools" role="tab" title="ツール" type="button">
<span class="tab-icon-container" id="toolTabIcon"></span>
<span class="sr-only">ツール</span>
</button>
<button aria-controls="panelColor" aria-label="カラー" aria-selected="false" class="rail-tab" data-left-tab="color" id="leftTabColorButton" role="tab" tabindex="-1" title="カラー" type="button">
<span class="tab-swatch pixel-frame" id="colorTabSwatch"></span>
<span class="sr-only">カラー</span>
</button>
</div>
  <div class="rail-tabpanes" id="leftRailPanes"></div>
<button aria-label="左パネルを開く / 幅を変更" class="rail-resizer rail-resizer--left" id="resizeLeftRail" type="button"></button>
</aside>
<main aria-label="ドットキャンバス" class="stage" id="stage">
<div class="stage__canvas" id="canvasViewport">
<div aria-live="off" class="canvas-stack" id="canvasStack">
<canvas aria-label="描画キャンバス" height="32" id="drawingCanvas" width="32"></canvas>
<canvas aria-hidden="true" height="32" id="overlayCanvas" width="32"></canvas>
<canvas aria-hidden="true" height="32" id="selectionCanvas" width="32"></canvas>
</div>
<!-- Danmaku overlay: floating comments (弾幕) -->
<div id="danmakuOverlay" class="danmaku-overlay" aria-hidden="true"></div>
<canvas aria-hidden="true" class="virtual-cursor-canvas" height="0" id="virtualCursorCanvas" width="0"></canvas>
<div aria-hidden="true" class="mirror-guides" hidden="" id="mirrorGuides">
<div class="mirror-guide mirror-guide--vertical" data-mirror-axis="vertical"></div>
<div class="mirror-guide mirror-guide--horizontal" data-mirror-axis="horizontal"></div>
<div class="mirror-guide mirror-guide--diagonal-a" data-mirror-axis="diagonalA"></div>
<div class="mirror-guide mirror-guide--diagonal-b" data-mirror-axis="diagonalB"></div>
<button aria-label="左右対称の軸を移動" class="mirror-handle mirror-handle--vertical" data-mirror-axis="vertical" type="button"></button>
<button aria-label="上下対称の軸を移動" class="mirror-handle mirror-handle--horizontal" data-mirror-axis="horizontal" type="button"></button>
<button aria-label="斜め対称(＼)の軸を移動" class="mirror-handle mirror-handle--diagonal-a" data-mirror-axis="diagonalA" type="button"></button>
<button aria-label="斜め対称(/)の軸を移動" class="mirror-handle mirror-handle--diagonal-b" data-mirror-axis="diagonalB" type="button"></button>
</div>
<div class="canvas-controls">
<div aria-label="履歴操作" class="canvas-controls__history" role="group">
<button aria-label="元に戻す" class="chip" disabled="" id="undoAction" type="button"></button>
<button aria-label="やり直す" class="chip" disabled="" id="redoAction" type="button"></button>
</div>
<div aria-label="ズーム操作" class="canvas-control-buttons" id="canvasControlButtons" role="group">
<button aria-label="ズームアウト" class="chip" id="canvasControlPrimary" type="button"></button>
<label class="canvas-zoom-field" for="zoomInput">
<span class="sr-only">ズーム倍率(%)</span>
<input data-stepper="true" id="zoomInput" inputmode="numeric" min="100" step="1" type="number" value="100"/>
</label>
<button aria-label="ズームイン" class="chip" id="canvasControlSecondary" type="button"></button>
</div>
</div>
<div aria-hidden="true" aria-live="polite" class="zoom-indicator" id="zoomIndicator" role="status"></div>
</div>
</main>
<aside aria-label="フレーム、レイヤー、設定、ファイル、共有" class="rail rail--right" data-collapsed="false" data-compact="true" id="rightRail">
<div aria-label="右パネル切り替え" class="rail-tabs" id="rightRailTabs" role="tablist">
<button aria-controls="panelFrames" aria-label="フレームとレイヤー" aria-selected="true" class="rail-tab is-active" data-right-tab="frames" role="tab" title="フレームとレイヤー" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-frame.png"/>
<span class="sr-only">フレームとレイヤー</span>
</button>
<button aria-controls="panelSettings" aria-label="設定" aria-selected="false" class="rail-tab" data-right-tab="settings" role="tab" tabindex="-1" title="設定" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-settings.svg"/>
<span class="sr-only">設定</span>
</button>
<button aria-controls="panelFile" aria-label="ファイル" aria-selected="false" class="rail-tab" data-right-tab="file" role="tab" tabindex="-1" title="ファイル" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-file.svg"/>
<span class="sr-only">ファイル</span>
</button>
<button aria-controls="panelMulti" aria-label="共有モード" aria-selected="false" class="rail-tab" data-right-tab="multi" role="tab" tabindex="-1" title="共有モード" type="button">
<img alt="" class="tab-icon" src="assets/icons/maltimode.svg"/>
<span class="sr-only">共有モード</span>
</button>
</div>
  <div class="rail-tabpanes" id="rightRailPanes"></div>
<button aria-label="右パネルを開く / 幅を変更" class="rail-resizer rail-resizer--right" id="resizeRightRail" type="button"></button>
</aside>
</div>
<div aria-hidden="true" id="panelAdPreloadHost" style="position:fixed;left:-20000px;top:-20000px;width:320px;height:320px;overflow:hidden;opacity:0;pointer-events:none;z-index:-1;">
  <div id="leftPanelAdPreloadMount" style="width:320px;min-width:320px;max-width:320px;height:320px;min-height:320px;max-height:320px;overflow:hidden;"></div>
  <div id="rightPanelAdPreloadMount" style="width:320px;min-width:320px;max-width:320px;height:320px;min-height:320px;max-height:320px;overflow:hidden;"></div>
</div>
<button aria-label="描画ボタン（左=主色 / 右=副色）" class="floating-draw-button" id="floatingDrawButton" type="button">描画</button>
<div aria-hidden="true" class="mirror-tool-popover" hidden="" id="mirrorToolPopover" role="dialog">
<div class="mirror-tool-popover__header">
<strong>対称ツール</strong>
<button aria-label="対称ポップアップを閉じる" class="mirror-tool-popover__close" id="mirrorToolPopoverClose" type="button">閉じる</button>
</div>
<div class="mirror-tool-popover__body">
<label class="toggle-option" for="mirrorToolPopupToggleMode">
<input id="mirrorToolPopupToggleMode" type="checkbox"/>
<span>ミラーモード</span>
</label>
<div class="mirror-tool-popover__items" id="mirrorToolPopoverItems"></div>
<p class="help-text mirror-tool-popover__help" id="mirrorToolPopoverHelp">挙動は既存ミラーモードと同じです。軸位置はキャンバス外のつまみで移動できます。</p>
</div>
</div>
<!-- 立体ツール（solidShape）を一時的に削除しました -->
<div class="mobile-drawer" hidden="" id="mobileDrawer">
<button aria-label="モバイルパネルの高さを調整" aria-controls="mobilePanels" class="mobile-drawer__handle" id="mobileDrawerHandle" type="button">
<span aria-hidden="true" class="mobile-drawer__grip"></span>
</button>
<div class="mobile-panels" id="mobilePanels">
<div aria-labelledby="mobileTabTools" class="mobile-panel is-active" id="mobilePanelTools" role="tabpanel"></div>
<div aria-labelledby="mobileTabColor" class="mobile-panel" hidden="" id="mobilePanelColor" role="tabpanel"></div>
<div aria-labelledby="mobileTabFrames" class="mobile-panel" hidden="" id="mobilePanelFrames" role="tabpanel"></div>
<div aria-labelledby="mobileTabSettings" class="mobile-panel" hidden="" id="mobilePanelSettings" role="tabpanel"></div>
<div aria-labelledby="mobileTabFile" class="mobile-panel" hidden="" id="mobilePanelFile" role="tabpanel"></div>
<div aria-labelledby="mobileTabMulti" class="mobile-panel" hidden="" id="mobilePanelMulti" role="tabpanel"></div>
</div>
</div>
<section class="panel-section" data-section="tools" id="panelTools">
<div class="panel-section__body">
<div aria-label="ツールカテゴリ" class="tool-group-tabs" role="tablist">
<button aria-selected="true" class="tool-group-button is-active" data-tool-group="selection" role="tab" title="範囲選択" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-select-rect.svg" width="20"/>
<span class="tool-group-label">範囲選択</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="pen" role="tab" title="ペン" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-pen-new.svg" width="20"/>
<span class="tool-group-label">ペン</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="eyedropper" role="tab" title="スポイト" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-eyedropper.png" width="20"/>
<span class="tool-group-label">スポイト</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="eraser" role="tab" title="消しゴム" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-eraser.png" width="20"/>
<span class="tool-group-label">消しゴム</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="shape" role="tab" title="図形" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-rect.svg" width="20"/>
<span class="tool-group-label">図形</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="fill" role="tab" title="塗りつぶし" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-fill.png" width="20"/>
<span class="tool-group-label">塗りつぶし</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="mirror" role="tab" title="対称" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tasyou1.svg" width="20"/>
<span class="tool-group-label">対称</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="virtualCursor" role="tab" title="仮想カーソル" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-cursor.png" width="20"/>
<span class="tool-group-label">仮想カーソル</span>
</button>
</div>
<div aria-label="描画ツール" class="tool-grid" id="toolGrid" role="toolbar">
<button aria-pressed="true" class="tool-button is-active" data-tool="pen" data-tool-group="pen" type="button">
<img alt="ペン" height="32" src="assets/icons/tool-pen-new.svg" width="32"/>
<span>ペン</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="eyedropper" data-tool-group="eyedropper" type="button">
<img alt="スポイト" height="32" src="assets/icons/tool-eyedropper.png" width="32"/>
<span>スポイト</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="eraser" data-tool-group="eraser" type="button">
<img alt="消しゴム" height="32" src="assets/icons/tool-eraser.png" width="32"/>
<span>消しゴム</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="line" data-tool-group="shape" type="button">
<img alt="直線" height="32" src="assets/icons/tool-line.svg" width="32"/>
<span>直線</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="curve" data-tool-group="shape" type="button">
<img alt="曲線" height="32" src="assets/icons/tool-curve.svg" width="32"/>
<span>曲線</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="rect" data-tool-group="shape" type="button">
<img alt="四角" height="32" src="assets/icons/tool-rect.svg" width="32"/>
<span>四角</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="rectFill" data-tool-group="shape" type="button">
<img alt="塗り四角" height="32" src="assets/icons/tool-rect-fill.svg" width="32"/>
<span>塗り四角</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="ellipse" data-tool-group="shape" type="button">
<img alt="丸" height="32" src="assets/icons/tool-ellipse.svg" width="32"/>
<span>丸</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="ellipseFill" data-tool-group="shape" type="button">
<img alt="塗り丸" height="32" src="assets/icons/tool-ellipse-fill.svg" width="32"/>
<span>塗り丸</span>
</button>
<!-- 立体ツールボタンを削除しました -->
<button aria-pressed="false" class="tool-button" data-tool="fill" data-tool-group="fill" type="button">
<img alt="塗りつぶし" height="32" src="assets/icons/tool-fill.png" width="32"/>
<span>塗りつぶし</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="move" data-tool-group="selection" type="button">
<img alt="移動" height="32" src="assets/icons/tool-pan.svg" width="32"/>
<span>移動</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectRect" data-tool-group="selection" type="button">
<img alt="矩形選択" height="32" src="assets/icons/tool-select-rect.svg" width="32"/>
<span>矩形選択</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectLasso" data-tool-group="selection" type="button">
<img alt="投げ縄" height="32" src="assets/icons/tool-select-lasso.svg" width="32"/>
<span>投げ縄</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectSame" data-tool-group="selection" type="button">
<img alt="同色選択" height="32" src="assets/icons/tool-select-magic.svg" width="32"/>
<span>同色</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="mirrorPopup" data-tool-group="mirror" type="button">
<img alt="対称設定" height="32" src="assets/icons/tasyou1.svg" width="32"/>
<span>対称</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="virtualCursorToggle" data-tool-group="virtualCursor" type="button">
<img alt="仮想カーソル" height="32" src="assets/icons/tool-cursor.png" width="32"/>
<span>仮想表示</span>
</button>
</div>
<div class="tool-quick-color" id="toolQuickColor">
<div aria-label="クイックカラー" class="tool-quick-color__palette" id="toolQuickPalette" role="listbox"></div>
</div>
<div class="field-group field-group--tools">
<label class="field" id="selectionOutlineField">
<span>選択編集</span>
<div aria-label="選択範囲アウトライン方向" class="selection-outline-buttons" role="group">
<button aria-label="選択範囲の外周へ4方向アウトラインを描画" class="chip selection-action-button" disabled="" id="selectionOutline4Action" type="button">4方向</button>
<button aria-label="選択範囲の外周へ8方向アウトラインを描画" class="chip selection-action-button" disabled="" id="selectionOutline8Action" type="button">8方向</button>
</div>
</label>
<label class="field field--slider-row" id="outlineSizeField" for="outlineSize">
<span>アウトライン幅</span>
<input id="outlineSize" max="8" min="1" type="range" value="1"/>
<output for="outlineSize" id="outlineSizeValue">1マス</output>
</label>
<label class="field field--slider-row" id="brushSizeField">
<span>ブラシサイズ</span>
<input id="brushSize" max="12" min="1" type="range" value="1"/>
<output for="brushSize" id="brushSizeValue">1px</output>
</label>
<label class="field">
<span>ブラシ形状</span>
<div aria-label="ブラシ形状" class="brush-shape-buttons" id="brushShapeButtons" role="group">
<button aria-pressed="true" class="chip brush-shape-button is-active" data-brush-shape="square" type="button">
<canvas aria-hidden="true" class="brush-shape-button__icon" height="24" width="24"></canvas>
<span>四角</span>
</button>
<button aria-pressed="false" class="chip brush-shape-button" data-brush-shape="circle" type="button">
<canvas aria-hidden="true" class="brush-shape-button__icon" height="24" width="24"></canvas>
<span>丸</span>
</button>
<button aria-pressed="false" class="chip brush-shape-button" data-brush-shape="custom" type="button">
<canvas aria-hidden="true" class="brush-shape-button__icon" height="24" width="24"></canvas>
<span>カスタム</span>
</button>
</div>
</label>
<label class="field" hidden id="selectSameModeField">
<span>同色選択モード</span>
<div aria-label="同色選択モード" class="select-same-mode-buttons" role="group">
<button aria-pressed="true" class="chip select-same-mode-button is-active" data-select-same-mode="connected" type="button">連結のみ</button>
<button aria-pressed="false" class="chip select-same-mode-button" data-select-same-mode="global" type="button">全体</button>
</div>
</label>
<output class="brush-custom-info" id="customBrushInfo">カスタム: 未作成</output>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="left">
<div aria-label="広告" class="panel-ad" id="leftPanelAd">
<div class="ad-box" id="leftPanelAdSlot">
<ins class="ad-seed" data-ad-client="ca-pub-9801602250480253" data-ad-format="auto" data-ad-slot="3806415737" data-full-width-responsive="true" style="display:block"></ins>
</div>
</div>
</div>
</div>
</section>
<section class="panel-section" data-section="color" id="panelColor">
<div class="panel-section__body">
<div class="color-mode color-mode--index" id="colorModeIndex">
<div class="palette-header">
<div class="palette-actions">
<button aria-label="選択した色を削除" class="chip" id="removePaletteColor" type="button">-</button>
<button aria-label="色を追加" class="chip" id="addPaletteColor" type="button">+</button>
</div>
</div>
<div aria-label="カラーパレット" class="palette-grid" id="paletteList" role="listbox"></div>
<div class="palette-editor" id="paletteEditor">
<div class="palette-topline">
<label class="field field--compact palette-index-inline">
<span>インデックス</span>
<input data-stepper="true" id="paletteIndex" min="0" step="1" type="number"/>
</label>
</div>
<div class="palette-hsv" id="paletteHsvControls">
<div class="palette-wheel" id="paletteWheelWrapper">
<canvas aria-label="HueリングとSVマップ" height="220" id="paletteColorWheel" width="220"></canvas>
<div class="palette-wheel__cursor palette-wheel__cursor--hue" id="paletteWheelCursor"></div>
<div class="palette-wheel__cursor palette-wheel__cursor--sv" id="paletteSvCursor"></div>
</div>
<div class="palette-sliders">
<label class="palette-slider-row" for="paletteHue">
<span class="palette-slider-row__label">色相</span>
<input id="paletteHue" max="360" min="0" type="range" value="0"/>
<output class="palette-slider-row__value" for="paletteHue" id="paletteHueValue">0</output>
</label>
<label class="palette-slider-row" for="paletteSaturation">
<span class="palette-slider-row__label">彩度</span>
<input id="paletteSaturation" max="100" min="0" type="range" value="0"/>
<output class="palette-slider-row__value" for="paletteSaturation" id="paletteSaturationValue">0</output>
</label>
<label class="palette-slider-row" for="paletteValue">
<span class="palette-slider-row__label">明度</span>
<input id="paletteValue" max="100" min="0" type="range" value="100"/>
<output class="palette-slider-row__value" for="paletteValue" id="paletteValueValue">100</output>
</label>
<label class="palette-slider-row palette-alpha-field" for="paletteAlphaSlider">
<span class="palette-slider-row__label">アルファ</span>
<input id="paletteAlphaSlider" max="255" min="0" type="range" value="255"/>
<output class="palette-slider-row__value" for="paletteAlphaSlider" id="paletteAlphaValue">255</output>
</label>
</div>
</div>
</div>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="left"></div>
</div>
</section>
<section class="panel-section" data-section="frames" id="panelFrames">
<div class="panel-section__body">
<div aria-label="レイヤーとフレームのタイムライン" class="timeline-card" role="group">
<div class="timeline-toolbar">
<div aria-label="レイヤー操作" class="timeline-toolbar__group timeline-toolbar__group--layer" role="group">
<button aria-label="レイヤーを追加" class="pixel-button pixel-frame" id="addLayer" type="button">＋</button>
<button aria-label="レイヤーを削除" class="pixel-button pixel-frame" id="removeLayer" type="button">－</button>
<button aria-label="選択中のレイヤーを上に移動" class="pixel-button pixel-frame" id="moveLayerUp" type="button">▼</button>
<button aria-label="選択中のレイヤーを下に移動" class="pixel-button pixel-frame" id="moveLayerDown" type="button">▲</button>
<span class="timeline-toolbar__label">レイヤー</span>
</div>
<div aria-label="フレーム操作" class="timeline-toolbar__group timeline-toolbar__group--frame" role="group">
<button aria-label="フレームを追加" class="pixel-button pixel-frame" id="addFrame" type="button">＋</button>
<button aria-label="フレームを削除" class="pixel-button pixel-frame" id="removeFrame" type="button">－</button>
<button aria-label="選択中のフレームを左に移動" class="pixel-button pixel-frame" id="moveFrameUp" type="button">◀</button>
<button aria-label="選択中のフレームを右に移動" class="pixel-button pixel-frame" id="moveFrameDown" type="button">▶</button>
<span class="timeline-toolbar__label">フレーム</span>
</div>
</div>
<div class="timeline-matrix-wrapper">
<div aria-label="フレームとレイヤーの一覧" class="timeline-matrix" id="timelineMatrix" role="grid"></div>
</div>
<div class="timeline-footer">
<div aria-label="再生ボタン群" class="timeline-playback" role="group">
<button aria-label="最初のフレームへ" class="pixel-button pixel-frame" id="rewindAnimation" type="button">⏮</button>
<button aria-label="再生" class="pixel-button pixel-frame" id="playAnimation" type="button">▶</button>
<button aria-label="停止" class="pixel-button pixel-frame" id="stopAnimation" type="button">■</button>
<button aria-label="次のフレームへ" class="pixel-button pixel-frame" id="forwardAnimation" type="button">⏭</button>
</div>
<div aria-label="フレームレート設定" class="timeline-fps" role="group">
<label class="field field--tiny timeline-fps-control">
<span>fps</span>
<input data-stepper="true" id="animationFps" max="60" min="1" type="number" value="12"/>
</label>
<span class="timeline-fps-hint" id="animationFpsMs">83ms</span>
<button aria-label="全フレームに現在の fps を適用" class="chip" id="applyFpsAll" type="button">全体適用</button>
</div>
</div>
<div aria-label="選択中レイヤー設定" class="timeline-layer-settings" id="timelineLayerSettings" role="group">
<p class="timeline-layer-settings__target" id="layerSettingsTarget">対象: レイヤー 1</p>
<label class="timeline-layer-settings__row" for="layerOpacity">
<span class="timeline-layer-settings__label">不透明度</span>
<input id="layerOpacity" max="100" min="0" type="range" value="100"/>
<output class="timeline-layer-settings__value" for="layerOpacity" id="layerOpacityValue">100%</output>
</label>
<label class="timeline-layer-settings__row timeline-layer-settings__row--blend" for="layerBlendMode">
<span class="timeline-layer-settings__label">合成モード</span>
<select id="layerBlendMode">
<option value="normal">通常</option>
<option value="multiply">乗算</option>
<option value="screen">スクリーン</option>
<option value="overlay">オーバーレイ</option>
<option value="soft-light">ソフトライト</option>
<option value="hard-light">ハードライト</option>
<option value="darken">比較(暗)</option>
<option value="lighten">比較(明)</option>
<option value="color-dodge">覆い焼きカラー</option>
<option value="color-burn">焼き込みカラー</option>
<option value="difference">差の絶対値</option>
<option value="exclusion">除外</option>
</select>
</label>
<div aria-label="選択中フレーム設定" class="timeline-frame-settings" id="timelineFrameSettings" role="group">
<p class="timeline-layer-settings__target" id="frameSettingsTarget">フレーム 1 の設定</p>
<label class="timeline-layer-settings__row timeline-layer-settings__row--toggle" for="onionSkinEnabled">
<span class="timeline-layer-settings__label">オニオンスキン</span>
<input aria-label="オニオンスキンを有効化" id="onionSkinEnabled" type="checkbox"/>
<span class="timeline-layer-settings__value timeline-layer-settings__value--bool" id="onionSkinEnabledValue">OFF</span>
</label>
<label class="timeline-layer-settings__row" for="onionPrevFrames">
<span class="timeline-layer-settings__label">前フレーム</span>
<input id="onionPrevFrames" max="6" min="0" type="range" value="1"/>
<output class="timeline-layer-settings__value" for="onionPrevFrames" id="onionPrevFramesValue">1</output>
</label>
<label class="timeline-layer-settings__row" for="onionNextFrames">
<span class="timeline-layer-settings__label">次フレーム</span>
<input id="onionNextFrames" max="6" min="0" type="range" value="1"/>
<output class="timeline-layer-settings__value" for="onionNextFrames" id="onionNextFramesValue">1</output>
</label>
<label class="timeline-layer-settings__row" for="onionOpacity">
<span class="timeline-layer-settings__label">濃さ</span>
<input id="onionOpacity" max="100" min="0" type="range" value="35"/>
<output class="timeline-layer-settings__value" for="onionOpacity" id="onionOpacityValue">35%</output>
</label>
</div>
</div>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="right">
<div aria-label="広告" class="panel-ad" id="rightPanelAd">
<div class="ad-box" id="rightPanelAdSlot">
<ins class="ad-seed" data-ad-client="ca-pub-9801602250480253" data-ad-format="auto" data-ad-slot="1180252398" data-full-width-responsive="true" style="display:block"></ins>
</div>
</div>
</div>
</div>
</section>
<section class="panel-section" data-section="file" id="panelFile">
<div class="panel-section__body">
<div class="field-group field-group--file-actions">
<button class="button" id="newProject" type="button">新規作成</button>
<button class="button" id="openDocument" type="button">ファイルを開く</button>
<button class="button" id="showLocalProjects" type="button">端末内プロジェクト</button>
<button class="button button--primary" id="exportProject" type="button">保存/出力</button>
<button class="button" id="clearCanvas" type="button">キャンバスをクリア</button>
</div>
<div class="file-panel-summary">
<p class="help-text">自動保存: ON（この端末）</p>
<p class="help-text">共有・配布用の保存は「保存/出力」から手動で行います。</p>
</div>
<button class="button" hidden id="enableAutosave" type="button">ローカル自動保存（常時ON）</button>
<button class="button" hidden id="bindExportFolder" type="button">出力フォルダを設定</button>
<p aria-live="polite" class="help-text export-destination-label" id="exportDestinationLabel">画像/GIF出力先: 未固定（保存時に保存先を選択）</p>
<p aria-live="polite" class="help-text" id="autosaveStatus"></p>
<p aria-live="polite" class="help-text" id="exportFolderStatus"></p>
<div class="field field--list">
<span>タイムラプス</span>
<div class="field-group">
<button class="button" id="timelapseClear" type="button">記録クリア</button>
</div>
<label class="field field--compact">
<span>再生FPS</span>
<input data-stepper="true" id="timelapseFps" inputmode="numeric" max="60" min="1" step="1" type="number" value="12"/>
</label>
<p aria-live="polite" class="help-text" id="timelapseStatus">タイムラプス: 未記録</p>
<p class="help-text">記録ON時は描画履歴を自動記録します。出力は通常の「出力」ボタンから選択してください。</p>
</div>
<div aria-live="polite" class="field memory-control" role="status">
<span id="memoryUsage">メモリ: 計測中…</span>
<button class="chip" id="memoryClear" type="button">メモリ削除</button>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="right"></div>
</div>
</section>
<section class="panel-section" data-section="multi" id="panelMulti">
<div class="panel-section__body">
<div class="multi-entry-screen" id="multiEntryScreen">
<button class="button" id="multiEntryMaster" type="button">マスター</button>
<button class="button" id="multiEntryGuest" type="button">入室</button>
</div>
<div class="multi-flow-panel" hidden id="multiFlowPanel">
<div class="field field--list multi-comment-field">
<div aria-live="polite" class="multi-comment-log" id="multiCommentList">
<p class="help-text">コメントはまだありません。</p>
</div>
<div class="multi-danmaku-toggle" style="display:flex;align-items:center;gap:8px;">
  <label class="toggle-option" for="multiDanmakuToggle">
    <input id="multiDanmakuToggle" type="checkbox" checked />
    <span>コメント弾幕</span>
  </label>
</div>
<div class="multi-comment-input-row">
<input autocomplete="off" id="multiCommentInput" maxlength="140" placeholder="コメントを入力" type="text"/>
<button class="chip" id="multiCommentSend" type="button">送信</button>
</div>
</div>
<div class="field-group">
<div class="multi-session-actions">
<button class="button" id="multiStartSession" type="button">開始</button>
<button class="button" id="multiLeaveSession" type="button">切断</button>
</div>
</div>
<div class="field field--compact multi-project-key-field">
<span>プロジェクトキー</span>
<div class="multi-project-key-row">
<input autocomplete="off" id="multiProjectKey" inputmode="text" maxlength="40" placeholder="例: room-1234" spellcheck="false" type="text"/>
<button aria-label="プロジェクトキーをコピー" class="chip multi-project-key-copy" id="multiCopyKey" title="プロジェクトキーをコピー" type="button">コピー</button>
</div>
</div>
<div class="field field--list multi-master-actions" data-multi-master-only="true">
<span>基本</span>
<button class="chip" id="multiGenerateKey" type="button">キー生成</button>
<button class="chip" id="multiBroadcastState" type="button">全員に同期</button>
<div class="field field--inline multi-invite-actions">
<button class="chip" id="multiInviteCopy" type="button">招待リンクをコピー</button>
<button class="chip" id="multiInviteShare" type="button">招待を共有</button>
</div>
</div>
<div class="field field--list multi-join-request-field" hidden id="multiJoinRequestField">
<button class="chip" id="multiRequestGuestRole" type="button">参加リクエストを送信</button>
<p class="help-text" id="multiJoinRequestHint">参加はマスターの承認後に有効になります。</p>
</div>
<div class="multi-status-row">
<p aria-live="polite" class="help-text" id="multiStatus">共有モード: OFF</p>
<button aria-controls="multiHelpPanel" aria-expanded="false" aria-label="マルチ説明を表示" class="chip multi-help-toggle" id="multiHelpToggle" type="button">?</button>
</div>
<div class="field field--list multi-help-panel" hidden id="multiHelpPanel">
<span>マルチ説明</span>
<p class="help-text">描画は参加者のみ、コメントは全員が利用できます。</p>
<p class="help-text">参加者を選ぶと: 切替 / セル移動 / ロック / キック / BAN</p>
<p class="help-text">視聴者を選ぶと: 切替のみ</p>
<p class="help-text">招待リンクはプロジェクトキー付きで参加画面を開きます。</p>
<button class="chip" id="multiHelpClose" type="button">閉じる</button>
</div>
<details class="field field--list multi-participants-panel" open>
<summary>参加者/視聴者一覧</summary>
<div class="multi-participants-scroll">
<ul class="toggle-list multi-participants-list" id="multiParticipants">
<li class="help-text">未接続</li>
</ul>
</div>
</details>
<div class="multi-master-layout" data-multi-master-only="true">
<div class="multi-master-column">
<div class="field field--list multi-master-preset-field">
<span>クイック設定</span>
<div class="field field--inline multi-master-preset-actions">
<button class="chip" id="multiPresetFriends" type="button">友達向け</button>
<button class="chip" id="multiPresetStream" type="button">配信向け</button>
</div>
<p class="help-text" id="multiPresetHint">友達向け: 自動参加 / 配信向け: 承認制</p>
</div>
<details class="field field--list multi-master-advanced" id="multiMasterAdvanced">
<summary>詳細設定</summary>
<div class="multi-master-advanced-body">
<div class="field field--list multi-capacity-field">
<span>参加管理</span>
<label class="field field--compact">
<span>参加上限 (1〜15)</span>
<input data-stepper="true" id="multiMaxGuests" inputmode="numeric" max="15" min="1" step="1" type="number" value="5"/>
</label>
<p class="help-text" id="multiGuestCapacityHint">参加枠: 0 / 5</p>
<label class="field field--compact">
<span>部屋公開</span>
<select id="multiRoomVisibility">
<option value="public" selected>公開</option>
<option value="private">非公開</option>
</select>
</label>
<p class="help-text" id="multiRoomVisibilityHint">非公開: ホームには表示されません。</p>
<label class="field field--compact">
<span>出力権限</span>
<select id="multiExportPermission">
<option value="master-guest" selected>マスター + 参加者</option>
<option value="master">マスターのみ</option>
<option value="all">全員</option>
</select>
</label>
<label class="field field--compact">
<span>参加方式</span>
<select id="multiJoinPolicy">
<option value="open" selected>自動参加（友達向け）</option>
<option value="approval">承認制（配信向け）</option>
</select>
</label>
<p class="help-text" id="multiJoinPolicyHint">自動参加: 招待リンクは参加者入室になります。</p>
</div>
</div>
</details>
<div class="field field--list multi-join-requests-field">
<span>参加リクエスト</span>
<label class="field field--compact">
<span>対象</span>
<select id="multiJoinRequestTarget"></select>
</label>
<div class="field field--inline multi-role-actions">
<button class="chip" id="multiJoinRequestApprove" type="button">承認</button>
<button class="chip" id="multiJoinRequestReject" type="button">却下</button>
</div>
</div>
</div>
<div class="multi-master-column">
<div class="field field--list multi-master-ops-toggle-field">
<span>運営モード</span>
<label class="toggle-option" for="multiMasterOpsMode">
<input id="multiMasterOpsMode" type="checkbox"/>
<span>キック / BAN / 強制切替を表示</span>
</label>
<p class="help-text" id="multiMasterOpsHint">通常はOFF推奨です。</p>
</div>
<div class="field field--list multi-role-control-field" data-multi-master-ops="true">
<span>参加/視聴の切替</span>
<label class="field field--compact">
<span>対象</span>
<select id="multiAssignTarget"></select>
</label>
<div class="field field--inline multi-role-actions">
<button class="chip" id="multiForceGuest" type="button">参加者にする</button>
<button class="chip" id="multiForceSpectator" type="button">視聴者にする</button>
</div>
</div>
<div class="field field--list multi-assignment-field" data-multi-master-ops="true">
<span>参加者セル移動</span>
<div class="field field--inline multi-assignment-inputs">
<label class="field field--tiny">
<span>フレーム</span>
<input data-stepper="true" id="multiAssignFrame" inputmode="numeric" min="1" step="1" type="number" value="1"/>
</label>
<label class="field field--tiny">
<span>レイヤー</span>
<input data-stepper="true" id="multiAssignLayer" inputmode="numeric" min="1" step="1" type="number" value="1"/>
</label>
</div>
<button class="button" id="multiAssignApply" type="button">参加者を移動</button>
<div class="field field--inline multi-assignment-actions">
<button class="chip" id="multiAssignLockToggle" type="button">セルロック</button>
<button class="chip" id="multiAssignKick" type="button">キック</button>
<button class="chip" id="multiAssignBan" type="button">BAN</button>
</div>
</div>
</div>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="right"></div>
</div>
</div>
</section>
<section class="panel-section" data-section="settings" id="panelSettings">
<div class="panel-section__body">
  <div class="settings-nav">
    <a class="button" href="https://pixieed.jp/tools.html" id="goHomeButton">他のツール一覧へ</a>
    <button class="chip settings-nav__close" id="toggleLanguageMode" type="button">English</button>
    <button aria-haspopup="dialog" class="chip settings-nav__close" id="openShortcutHelp" type="button">ショートカット一覧</button>
    <button aria-haspopup="dialog" class="chip settings-nav__close" id="openUpdateHistory" type="button">更新情報</button>
  </div>
<div class="settings-size-grid">
<label class="field settings-size-row settings-size-row--canvas">
<span>キャンバスサイズ</span>
<div class="field field--inline settings-size-controls settings-size-controls--canvas">
<label class="field field--tiny">
<span>横</span>
<div class="canvas-size-stepper">
<button aria-label="横を1下げる" class="number-stepper__btn" id="canvasWidthDecrement" type="button">−</button>
<input data-stepper="true" enterkeyhint="done" id="canvasWidth" inputmode="numeric" max="512" min="1" step="1" type="number" value="32"/>
<button aria-label="横を1上げる" class="number-stepper__btn" id="canvasWidthIncrement" type="button">＋</button>
</div>
</label>
<label class="field field--tiny">
<span>縦</span>
<div class="canvas-size-stepper">
<button aria-label="縦を1下げる" class="number-stepper__btn" id="canvasHeightDecrement" type="button">−</button>
<input data-stepper="true" enterkeyhint="done" id="canvasHeight" inputmode="numeric" max="512" min="1" step="1" type="number" value="32"/>
<button aria-label="縦を1上げる" class="number-stepper__btn" id="canvasHeightIncrement" type="button">＋</button>
</div>
</label>
<button class="button" id="applyCanvasResize" type="button">適用</button>
</div>
<p class="help-text" id="canvasSizeHint">横/縦を入力して「適用」または Enter で反映します。</p>
</label>
<label class="field settings-size-row settings-size-row--sprite">
<span>スプライト倍率</span>
<div class="field field--inline settings-size-controls">
<div class="field field--tiny">
<span>倍率</span>
<div class="sprite-scale-stepper">
<button aria-label="倍率を1下げる" class="number-stepper__btn" id="spriteScaleDecrement" type="button">−</button>
<input data-stepper="true" id="spriteScaleInput" inputmode="numeric" min="1" step="1" type="number" value="1"/>
<button aria-label="倍率を1上げる" class="number-stepper__btn" id="spriteScaleIncrement" type="button">＋</button>
</div>
</div>
<button class="button" disabled="" id="applySpriteScale" type="button">適用</button>
</div>
</label>
</div>
<div aria-label="表示設定" class="field field--list" role="group">
<ul class="toggle-list">
<li>
<label class="toggle-option" for="toggleGrid">
<input checked="" id="toggleGrid" type="checkbox"/>
<span>グリッド</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleMajorGrid">
<input id="toggleMajorGrid" type="checkbox"/>
<span>メジャー</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleChecker">
<input checked="" id="toggleChecker" type="checkbox"/>
<span>16px グレーチェック</span>
</label>
</li>
<li>
  <label class="toggle-option" for="settingDanmakuToggle">
    <input id="settingDanmakuToggle" type="checkbox" checked />
    <span>コメント弾幕</span>
  </label>
</li>
<li>
<label class="toggle-option" for="togglePixelPreview">
<input checked="" id="togglePixelPreview" type="checkbox"/>
<span>1px ガイド</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleVirtualCursor">
<input id="toggleVirtualCursor" type="checkbox"/>
<span>仮想カーソル</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleTimelapse">
<input checked="" id="toggleTimelapse" type="checkbox"/>
<span>タイムラプス記録</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleOnionSkin">
<input id="toggleOnionSkin" type="checkbox"/>
<span>オニオンスキン</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleMirrorMode">
<input id="toggleMirrorMode" type="checkbox"/>
<span>ミラーモード</span>
</label>
</li>
<li>
<label class="toggle-option" for="togglePixfindMode">
<input id="togglePixfindMode" type="checkbox"/>
<span>間違い探しモード</span>
</label>
</li>
</ul>
<div class="pixfind-help">
<button aria-controls="pixfindHelpText" aria-expanded="false" class="chip pixfind-help__toggle" id="togglePixfindHelp" type="button">間違い探しモードの説明</button>
<p class="help-text pixfind-help__text" hidden="" id="pixfindHelpText">ON時はフレーム1を原本、フレーム2を差分としてPiXFiND出力します。ONにするたびフレーム2は作り直されます。</p>
</div>
<div class="mirror-axis-options" id="mirrorAxisOptions" role="group">
<label class="toggle-option" for="mirrorAxisVertical">
<input checked="" id="mirrorAxisVertical" type="checkbox"/>
<span>左右対称</span>
</label>
<label class="toggle-option" for="mirrorAxisHorizontal">
<input id="mirrorAxisHorizontal" type="checkbox"/>
<span>上下対称</span>
</label>
<label class="toggle-option" for="mirrorAxisDiagonalA">
<input id="mirrorAxisDiagonalA" type="checkbox"/>
<span>斜め対称 (＼)</span>
</label>
<label class="toggle-option" for="mirrorAxisDiagonalB">
<input id="mirrorAxisDiagonalB" type="checkbox"/>
<span>斜め対称 (/)</span>
</label>
</div>
<p class="help-text" id="mirrorAxisHelp">ミラーモード中は軸ライン外側のつまみをドラッグして、対称軸を移動できます。</p>
<div class="virtual-cursor-scale" id="virtualCursorScale">
<label class="virtual-cursor-scale__control" for="virtualCursorButtonScale">
<span class="virtual-cursor-scale__label">仮想カーソルボタンサイズ</span>
<input id="virtualCursorButtonScale" list="virtualCursorButtonScaleMarks" max="2" min="1" step="0.5" type="range" value="2"/>
</label>
<div class="virtual-cursor-scale__meta">
<div aria-hidden="true" class="virtual-cursor-scale__ticks">
<span>1×</span>
<span>1.5×</span>
<span>2×</span>
</div>
<output class="virtual-cursor-scale__value" for="virtualCursorButtonScale" id="virtualCursorButtonScaleValue">2×</output>
</div>
<datalist id="virtualCursorButtonScaleMarks">
<option label="1×" value="1"></option>
<option label="1.5×" value="1.5"></option>
<option label="2×" value="2"></option>
</datalist>
</div>
<p class="help-text mobile-draw-help" id="mobileDrawHelp">スマホ描画: 仮想カーソルをONにしてキャンバスをドラッグでカーソル移動、「描画」ボタン長押しで描画します（左半分=主色 / 右半分=副色）。2本指ドラッグ/ピンチで移動と拡大縮小ができます。</p>
<div aria-label="背景とUIカラー" class="settings-display-buttons" role="group">
<button aria-pressed="false" class="chip" id="toggleBackgroundMode" type="button">背景:黒</button>
<button aria-pressed="false" class="chip" id="toggleUiTheme" type="button">UI:緑色</button>
</div>
<p class="help-text">背景とUI配色を切り替えます（描画色には影響しません）。</p>
</div>
<div class="panel-ad-mount" data-panel-ad-mount="right"></div>
</div>
</section>
</div>
<dialog aria-labelledby="exportDialogTitle" class="modal" id="exportDialog">
<form class="modal__form" id="exportDialogForm" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="exportDialogTitle">保存/出力形式</h2>
</header>
<div class="modal__body">
<div class="field field--list">
<label class="field field--compact" for="exportFormat">
<span>形式</span>
<select id="exportFormat">
<option value="png">PNG（画像）</option>
<option value="gridpng">PNG（グリッド分割）</option>
<option value="gif">GIF（アニメーション）</option>
<option value="timelapse">タイムラプスGIF（記録）</option>
<option value="pixfind">PiXFiNDへ送る</option>
<option value="project">プロジェクト（.pixieedraw）</option>
</select>
</label>
<div id="exportScaleControls">
<span>出力倍率</span>
<div class="scale-controls">
<div class="scale-control scale-control--wide">
<label for="exportScaleSlider">倍率 (×)</label>
<input id="exportScaleSlider" max="1" min="1" step="1" type="range" value="1"/>
<input data-stepper="true" id="exportScaleInput" inputmode="numeric" min="1" type="number" value="1"/>
</div>
</div>
</div>
<p class="help-text" id="exportScaleHint"></p>
<label class="toggle-option export-original-toggle" for="exportIncludeOriginalToggle" id="exportOriginalOptionRow">
<input id="exportIncludeOriginalToggle" type="checkbox"/>
<span>拡大出力時に原寸も追加で出力する</span>
</label>
<label class="toggle-option" for="exportSaveProjectCompanionToggle" id="exportCompanionOptionRow">
<input id="exportSaveProjectCompanionToggle" type="checkbox"/>
<span>画像/GIF出力時に PiXiEEDファイルも同時保存する</span>
</label>
<label class="toggle-option" for="exportContestPostToggle" id="exportContestPostOptionRow">
<input id="exportContestPostToggle" type="checkbox"/>
<span>保存完了後にコンテスト投稿画面へ移動する</span>
</label>
<div class="field field--inline" hidden id="exportGridSettings">
<span>グリッド分割 (PNG)</span>
<label class="field field--compact">
<span>幅 (px)</span>
<input id="exportGridWidth" inputmode="numeric" min="1" step="1" type="number" value="8"/>
</label>
<label class="field field--compact">
<span>高さ (px)</span>
<input id="exportGridHeight" inputmode="numeric" min="1" step="1" type="number" value="8"/>
</label>
</div>
<p class="help-text" hidden id="exportGridHint">分割順: 右上から左へ、次の段へ進みます（右→左、上→下）。</p>
</div>
<div class="field field--list">
<div aria-live="polite" class="export-guidance">
<p class="help-text"><strong>iPhoneで保存</strong> 共有 → ファイルに保存</p>
<p class="help-text"><strong>Androidで保存</strong> 保存</p>
</div>
<p aria-live="polite" class="help-text export-destination-label" id="exportDialogDestinationLabel">画像/GIF出力先: 未固定（保存時に保存先を選択）</p>
<div aria-label="出力操作" class="export-actions" role="group">
<button class="button button--primary" id="confirmExport" type="button">保存/出力</button>
</div>
</div>
<div aria-label="広告" class="export-ad" id="exportAdContainer">
<div class="export-ad__slot">
<ins class="export-ad-ins" data-ad-client="ca-pub-9801602250480253" data-ad-format="auto" data-ad-slot="2141591954" data-full-width-responsive="true" id="exportAdSlot" style="display:block"></ins>
</div>
<small class="export-ad__label">広告</small>
</div>
</div>
<footer class="modal__footer">
<button class="button button--ghost" id="cancelExport" type="button">キャンセル</button>
</footer>
</form>
</dialog>
<dialog aria-labelledby="exportInterstitialTitle" class="modal export-interstitial-modal" id="exportInterstitialDialog">
<form class="modal__form" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="exportInterstitialTitle">広告</h2>
<button aria-label="広告を閉じる" class="export-interstitial__close" id="closeExportInterstitial" type="button">閉じる</button>
</header>
<div class="modal__body">
<p class="help-text export-interstitial__lead">画像の出力が完了しました。</p>
<div aria-label="全画面広告" class="export-interstitial__slot-wrap">
<div class="export-interstitial__slot">
<ins class="export-interstitial-ins" data-ad-client="ca-pub-9801602250480253" data-ad-format="auto" data-ad-slot="2141591954" data-full-width-responsive="true" id="exportInterstitialAdSlot" style="display:block"></ins>
</div>
</div>
</div>
</form>
</dialog>
<dialog aria-labelledby="toolSpotlightTitle" class="modal tool-spotlight-modal" id="toolSpotlightDialog">
<form class="modal__form" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="toolSpotlightTitle">他ツールの紹介</h2>
</header>
<div class="modal__body tool-spotlight-modal__body">
<p class="help-text">出力ありがとうございます。次に遊べる・使えるツールです。</p>
<div class="tool-spotlight-list" role="list">
<a class="tool-spotlight-card" href="../maoitu/index.html" role="listitem">
<img alt="まおいつ" class="tool-spotlight-card__icon" src="../icon/icon-192-3.png"/>
<div class="tool-spotlight-card__content">
<h3 class="tool-spotlight-card__title">まおいつ</h3>
<p class="tool-spotlight-card__description">避け続けるアクションゲーム。短時間でスコアアタックできます。</p>
</div>
</a>
<a class="tool-spotlight-card" href="../pixfind/index.html" role="listitem">
<img alt="PiXFiND" class="tool-spotlight-card__icon" src="../icon/icon-192-2.png"/>
<div class="tool-spotlight-card__content">
<h3 class="tool-spotlight-card__title">PiXFiND</h3>
<p class="tool-spotlight-card__description">ドット絵専用の間違い探しゲーム。作った絵の活用にも最適です。</p>
</div>
</a>
<a class="tool-spotlight-card" href="../pixiee-lens/index.html" role="listitem">
<img alt="PiXiEELENS" class="tool-spotlight-card__icon" src="../icon/icon-192-1.png"/>
<div class="tool-spotlight-card__content">
<h3 class="tool-spotlight-card__title">PiXiEELENS</h3>
<p class="tool-spotlight-card__description">カメラ画像をドット化できるツール。撮影してそのまま編集導線につなげられます。</p>
</div>
</a>
</div>
</div>
<footer class="modal__footer">
<button class="button button--primary" id="closeToolSpotlight" type="button">閉じる</button>
</footer>
</form>
</dialog>
<dialog aria-labelledby="newProjectTitle" class="modal" id="newProjectDialog">
<form class="modal__form" id="newProjectForm" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="newProjectTitle">新規プロジェクト</h2>
</header>
<div class="modal__body">
<label class="field new-project__name-field">
<span>ファイル名</span>
<div class="new-project__name-input">
<input id="newProjectName" maxlength="109" placeholder="example" required="" type="text"/>
<span aria-hidden="true" class="new-project__name-suffix">.pixieedraw</span>
</div>
<p class="help-text">ファイル名のみ入力してください。拡張子 .pixieedraw は自動で付きます。</p>
</label>
<div class="field field--inline new-project__size-fields">
<span>キャンバスサイズ</span>
<div class="new-project__size-inputs">
<label class="field field--tiny">
<span>横</span>
<input data-stepper="true" id="newProjectWidth" max="512" min="1" required="" type="number" value="32"/>
</label>
<label class="field field--tiny">
<span>縦</span>
<input data-stepper="true" id="newProjectHeight" max="512" min="1" required="" type="number" value="32"/>
</label>
</div>
</div>
</div>
<footer class="modal__footer">
<button class="button button--ghost" id="cancelNewProject" type="button">キャンセル</button>
<button class="button button--primary" id="confirmNewProject" type="submit">作成</button>
</footer>
</form>
</dialog>
<dialog aria-labelledby="shortcutHelpTitle" class="modal shortcut-help-modal" id="shortcutHelpDialog">
<form class="modal__form" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="shortcutHelpTitle">ショートカット一覧</h2>
</header>
<div class="modal__body shortcut-help-modal__body">
<div class="shortcut-help-section">
<h3 class="shortcut-help-section__title">ツール</h3>
<div class="shortcut-help-list" role="list">
<p class="shortcut-help-row" role="listitem"><span>移動</span><span class="shortcut-help-key">V</span></p>
<p class="shortcut-help-row" role="listitem"><span>矩形選択</span><span class="shortcut-help-key">M</span></p>
<p class="shortcut-help-row" role="listitem"><span>なげなわ選択</span><span class="shortcut-help-key">Q</span></p>
<p class="shortcut-help-row" role="listitem"><span>同色選択</span><span class="shortcut-help-key">W</span></p>
<p class="shortcut-help-row" role="listitem"><span>選択を追加</span><span class="shortcut-help-key">Shift + 選択操作</span></p>
<p class="shortcut-help-row" role="listitem"><span>ペン</span><span class="shortcut-help-key">B</span></p>
<p class="shortcut-help-row" role="listitem"><span>消しゴム</span><span class="shortcut-help-key">E</span></p>
<p class="shortcut-help-row" role="listitem"><span>スポイト</span><span class="shortcut-help-key">I</span></p>
<p class="shortcut-help-row" role="listitem"><span>塗りつぶし</span><span class="shortcut-help-key">G</span></p>
<p class="shortcut-help-row" role="listitem"><span>直線</span><span class="shortcut-help-key">L</span></p>
<p class="shortcut-help-row" role="listitem"><span>曲線</span><span class="shortcut-help-key">C</span></p>
<p class="shortcut-help-row" role="listitem"><span>矩形</span><span class="shortcut-help-key">R</span></p>
<p class="shortcut-help-row" role="listitem"><span>塗り矩形</span><span class="shortcut-help-key">Shift + R</span></p>
<p class="shortcut-help-row" role="listitem"><span>楕円</span><span class="shortcut-help-key">O</span></p>
<p class="shortcut-help-row" role="listitem"><span>塗り楕円</span><span class="shortcut-help-key">Shift + O</span></p>
<p class="shortcut-help-row" role="listitem"><span>選択範囲をカスタムブラシ化</span><span class="shortcut-help-key">Shift + B（単押し）</span></p>
<p class="shortcut-help-row" role="listitem"><span>矩形選択してブラシ化</span><span class="shortcut-help-key">Shift + B（押しながらドラッグ → Bを離す）</span></p>
<p class="shortcut-help-row" role="listitem"><span>図形グループ呼び出し</span><span class="shortcut-help-key">U</span></p>
<p class="shortcut-help-row" role="listitem"><span>対称ポップ開閉</span><span class="shortcut-help-key">Y</span></p>
<p class="shortcut-help-row" role="listitem"><span>仮想カーソル ON/OFF</span><span class="shortcut-help-key">K</span></p>
</div>
</div>
<div class="shortcut-help-section">
<h3 class="shortcut-help-section__title">編集</h3>
<div class="shortcut-help-list" role="list">
<p class="shortcut-help-row" role="listitem"><span>元に戻す</span><span class="shortcut-help-key">Ctrl/Cmd + Z</span></p>
<p class="shortcut-help-row" role="listitem"><span>やり直し</span><span class="shortcut-help-key">Ctrl/Cmd + Y</span></p>
<p class="shortcut-help-row" role="listitem"><span>やり直し（代替）</span><span class="shortcut-help-key">Ctrl/Cmd + Shift + Z</span></p>
<p class="shortcut-help-row" role="listitem"><span>コピー</span><span class="shortcut-help-key">Ctrl/Cmd + C</span></p>
<p class="shortcut-help-row" role="listitem"><span>切り取り</span><span class="shortcut-help-key">Ctrl/Cmd + X</span></p>
<p class="shortcut-help-row" role="listitem"><span>貼り付け</span><span class="shortcut-help-key">Ctrl/Cmd + V</span></p>
<p class="shortcut-help-row" role="listitem"><span>一時パン</span><span class="shortcut-help-key">Space 長押し</span></p>
<p class="shortcut-help-row" role="listitem"><span>選択解除/移動キャンセル</span><span class="shortcut-help-key">Esc</span></p>
</div>
</div>
</div>
<footer class="modal__footer">
<button class="button button--primary" id="closeShortcutHelp" type="button">閉じる</button>
</footer>
</form>
</dialog>
<dialog aria-labelledby="updateHistoryTitle" class="modal update-history-modal" id="updateHistoryDialog">
<form class="modal__form" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="updateHistoryTitle">更新情報</h2>
</header>
<div class="modal__body update-history-modal__body">
<p class="help-text">直近1年の更新内容を表示しています。</p>
<div class="update-history-list" id="updateHistoryList" role="list"></div>
</div>
<footer class="modal__footer">
<button class="button button--primary" id="closeUpdateHistory" type="button">閉じる</button>
</footer>
</form>
</dialog>
<script>
      (function preventBrowserZoom() {
        const blockedKeys = new Set(['=', '+', '-', '_', '0']);
        const blockedCodes = new Set(['Equal', 'Minus', 'Digit0', 'NumpadAdd', 'NumpadSubtract', 'Numpad0']);

        document.addEventListener('keydown', (event) => {
          if (!(event.ctrlKey || event.metaKey)) return;
          if (blockedKeys.has(event.key) || blockedCodes.has(event.code)) {
            event.preventDefault();
            event.stopPropagation();
          }
        });

        window.addEventListener(
          'wheel',
          (event) => {
            if (event.ctrlKey) {
              event.preventDefault();
            }
          },
          { passive: false }
        );

        ['gesturestart', 'gesturechange', 'gestureend'].forEach((type) => {
          window.addEventListener(
            type,
            (event) => {
              event.preventDefault();
            },
            { passive: false }
          );
        });
      })();
    </script>
<script defer="" src="assets/js/app.js"></script>
  <!-- Mobile bottom ad placeholder (visible in portrait / small screens) -->
  <div id="mobileBottomAd" aria-hidden="false">
    <div class="mobile-ad-box" id="mobileBottomAdSlot">
      <ins class="ad-seed"
           style="display:block"
           data-ad-client="ca-pub-9801602250480253"
           data-ad-slot="6568310446"
           data-ad-format="horizontal"></ins>
    </div>
  </div>
  <script>
    (function () {
      // Manage the mobile bottom ad visibility and geometry by orientation.
      const mobileAd = document.getElementById('mobileBottomAd');
      if (!mobileAd) return;

      const mql = window.matchMedia('(orientation: portrait)');
      const mobileBottomAd = document.getElementById('mobileBottomAd');
      const mobileBottomAdSlot = document.getElementById('mobileBottomAdSlot');
      const MOBILE_AD_SLOT_HEIGHT = 48;
      let raf = null;

      function notifyAdLayoutChange(reason) {
        try {
          document.dispatchEvent(new CustomEvent('pixiedraw:ad-layout-change', {
            detail: { source: 'mobileBottomAd', reason: reason || 'unknown' }
          }));
        } catch (error) {
          // ignore
        }
      }

      function clamp(value, min, max) {
        return Math.max(min, Math.min(max, value));
      }

      function updateMobileBottomPadding() {
        let slotHeight = MOBILE_AD_SLOT_HEIGHT;
        try {
          const target = (mobileBottomAdSlot instanceof HTMLElement) ? mobileBottomAdSlot : mobileBottomAd;
          const rect = target && target.getBoundingClientRect ? target.getBoundingClientRect() : null;
          const measured = Math.ceil((rect && rect.height) || slotHeight);
          slotHeight = clamp(measured, MOBILE_AD_SLOT_HEIGHT - 4, MOBILE_AD_SLOT_HEIGHT + 4);
        } catch (e) {}

        const reserved = Math.ceil(slotHeight + 4);
        document.documentElement.style.setProperty('--mobile-bottom-ad-height', reserved + 'px');
      }

      function enforceMobileBottomAdGeometry() {
        if (!(mobileAd instanceof HTMLElement)) return;
        const slotHeightPx = `${MOBILE_AD_SLOT_HEIGHT}px`;

        mobileAd.style.setProperty('min-height', `calc(${slotHeightPx} + env(safe-area-inset-bottom, 0px))`, 'important');
        mobileAd.style.setProperty('height', `calc(${slotHeightPx} + env(safe-area-inset-bottom, 0px))`, 'important');
        mobileAd.style.setProperty('max-height', `calc(${slotHeightPx} + env(safe-area-inset-bottom, 0px))`, 'important');

        if (mobileBottomAdSlot instanceof HTMLElement) {
          mobileBottomAdSlot.style.setProperty('min-height', slotHeightPx, 'important');
          mobileBottomAdSlot.style.setProperty('height', slotHeightPx, 'important');
          mobileBottomAdSlot.style.setProperty('max-height', slotHeightPx, 'important');

          const slotIns = mobileBottomAdSlot.querySelector('ins');
          if (slotIns instanceof HTMLElement) {
            slotIns.style.setProperty('min-height', slotHeightPx, 'important');
            slotIns.style.setProperty('height', slotHeightPx, 'important');
            slotIns.style.setProperty('max-height', slotHeightPx, 'important');
            slotIns.style.setProperty('overflow', 'hidden', 'important');
          }

          mobileBottomAdSlot.querySelectorAll('iframe').forEach((frame) => {
            if (!(frame instanceof HTMLElement)) return;
            frame.style.setProperty('min-height', slotHeightPx, 'important');
            frame.style.setProperty('height', slotHeightPx, 'important');
            frame.style.setProperty('max-height', slotHeightPx, 'important');
          });
        }
      }

      function showAd() {
        enforceMobileBottomAdGeometry();
        if (!mobileAd.classList.contains('visible')) {
          mobileAd.classList.add('visible');
        }
        if (mobileAd.getAttribute('aria-hidden') !== 'false') {
          mobileAd.setAttribute('aria-hidden', 'false');
        }
      }

      function hideAd() {
        if (mobileAd.classList.contains('visible')) {
          mobileAd.classList.remove('visible');
        }
        if (mobileAd.getAttribute('aria-hidden') !== 'true') {
          mobileAd.setAttribute('aria-hidden', 'true');
        }
      }

      function refreshMobileBottomAd() {
        if (raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(function () {
          // Bottom ad: show in portrait as overlay at the bottom and mark body so CSS can add padding
          if (mobileBottomAd) {
            if (mql.matches) {
              enforceMobileBottomAdGeometry();
              showAd();
              // keep layout stable even if ad network injects a tall creative.
              updateMobileBottomPadding();
              document.body.classList.add('bottom-ad-active');
            } else {
              hideAd();
              document.documentElement.style.setProperty('--mobile-bottom-ad-height', '0px');
              document.body.classList.remove('bottom-ad-active');
            }
          }

          raf = null;
        });
      }

      function refreshListeners() {
        enforceMobileBottomAdGeometry();
        refreshMobileBottomAd();
        notifyAdLayoutChange('refreshListeners');
      }

      if (mobileBottomAdSlot instanceof HTMLElement) {
        if (typeof ResizeObserver === 'function') {
          const adResizeObserver = new ResizeObserver(() => {
            enforceMobileBottomAdGeometry();
            updateMobileBottomPadding();
          });
          adResizeObserver.observe(mobileBottomAdSlot);
        }
        const adMutationObserver = new MutationObserver(() => {
          enforceMobileBottomAdGeometry();
          updateMobileBottomPadding();
        });
        adMutationObserver.observe(mobileBottomAdSlot, {
          attributes: true,
          childList: true,
          subtree: true,
          attributeFilter: ['style', 'class', 'data-adsbygoogle-status']
        });
      }

      if (mql && typeof mql.addEventListener === 'function') {
        mql.addEventListener('change', () => {
          refreshListeners();
          notifyAdLayoutChange('orientation-change');
        });
      } else if (mql && typeof mql.addListener === 'function') {
        mql.addListener(() => {
          refreshListeners();
          notifyAdLayoutChange('orientation-change');
        });
      }
      window.addEventListener('resize', () => {
        refreshListeners();
        notifyAdLayoutChange('resize');
      });
      document.addEventListener('readystatechange', function () { if (document.readyState === 'complete') refreshListeners(); });

      // initial setup
      refreshListeners();
    })();
  </script>
  <script>
    (function initPanelAdDocking() {
      const ads = {
        left: document.getElementById('leftPanelAd'),
        right: document.getElementById('rightPanelAd'),
      };
      const preloadMounts = {
        left: document.getElementById('leftPanelAdPreloadMount'),
        right: document.getElementById('rightPanelAdPreloadMount'),
      };
      const sideSections = {
        left: ['panelTools', 'panelColor'],
        right: ['panelFrames', 'panelSettings', 'panelFile', 'panelMulti'],
      };
      if (!(ads.left instanceof HTMLElement) && !(ads.right instanceof HTMLElement)) return;

      function isMountRenderable(node) {
        if (!(node instanceof HTMLElement) || !node.isConnected) return false;
        try {
          const style = window.getComputedStyle ? window.getComputedStyle(node) : null;
          if (style && (style.display === 'none' || style.visibility === 'hidden')) return false;
          const rect = node.getBoundingClientRect();
          return rect.width > 0 && node.getClientRects().length > 0;
        } catch (error) {
          return false;
        }
      }

      function findMount(side) {
        const ids = sideSections[side] || [];
        const preloadMount = preloadMounts[side] instanceof HTMLElement ? preloadMounts[side] : null;
        let fallback = null;
        let firstMount = null;
        for (const id of ids) {
          const section = document.getElementById(id);
          if (!(section instanceof HTMLElement)) continue;
          const mount = section.querySelector(`[data-panel-ad-mount="${side}"]`);
          if (!(mount instanceof HTMLElement)) continue;
          if (!firstMount) firstMount = mount;
          const mountRenderable = isMountRenderable(mount);
          if (!fallback && mountRenderable) fallback = mount;
          if (section.classList.contains('is-active') && !section.hidden && mountRenderable) {
            return mount;
          }
        }
        return fallback || preloadMount || firstMount;
      }

      function dock(side) {
        const ad = ads[side];
        if (!(ad instanceof HTMLElement)) return false;
        const mount = findMount(side);
        if (!(mount instanceof HTMLElement)) return false;
        if (ad.parentElement !== mount) {
          mount.appendChild(ad);
          return true;
        }
        return false;
      }

      function refresh() {
        const movedLeft = dock('left');
        const movedRight = dock('right');
        if (movedLeft || movedRight) {
          try {
            document.dispatchEvent(new CustomEvent('pixiedraw:panel-ad-dock-change'));
          } catch (error) {
            // ignore
          }
        }
      }

      const observer = new MutationObserver(refresh);
      observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'hidden'],
        childList: true,
        subtree: true,
      });
      window.addEventListener('resize', refresh);
      if (document.readyState === 'complete') {
        refresh();
      } else {
        window.addEventListener('load', refresh, { once: true });
      }
      refresh();
    })();
  </script>
  <script>
    // AdSense injector: keep slot nodes mounted and only promote a slot to `adsbygoogle`
    // right before push(), so 0px hidden slots never poison the global queue.
    (function initAds() {
      if (!document || !window) return;
      const ADS_CLIENT = 'ca-pub-9801602250480253';
      const SLOTS = [
        { containerId: 'leftPanelAdSlot', slot: '3806415737' },
        { containerId: 'rightPanelAdSlot', slot: '1180252398' },
        { containerId: 'mobileBottomAdSlot', slot: '6568310446' }
      ];
      const SIDE_SLOT_IDS = ['leftPanelAdSlot', 'rightPanelAdSlot'];
      const MIN_SIDE_AD_WIDTH = 140;
      const RETRY_FRAMES = 96;
      const slotByContainerId = new Map(SLOTS.map(item => [item.containerId, item]));
      const resizeObserverByContainer = new WeakMap();
      const localHost = (() => {
        try {
          const host = location && location.hostname ? location.hostname : '';
          return host === 'localhost' || host === '127.0.0.1' || host === '::1';
        } catch (error) {
          return false;
        }
      })();

      let rerenderQueued = false;
      let lastAdLayoutMode = null;
      let activeModeReloadTimer = null;

      function clamp(value, min, max) {
        return Math.max(min, Math.min(max, value));
      }

      function isPortraitBottomOnlyMode() {
        try {
          if (window.matchMedia) {
            return window.matchMedia('(orientation: portrait)').matches;
          }
          return window.innerHeight >= window.innerWidth;
        } catch (error) {}
        return false;
      }

      function getAdLayoutMode() {
        return isPortraitBottomOnlyMode() ? 'portrait-bottom' : 'landscape-side';
      }

      function resetSlotContainer(containerId) {
        const container = document.getElementById(containerId);
        if (!(container instanceof HTMLElement)) return;
        container.dataset.pixiedRetryLoop = '0';
        container.innerHTML = '';
      }

      function handleAdLayoutTransition() {
        const mode = getAdLayoutMode();
        if (lastAdLayoutMode === null) {
          lastAdLayoutMode = mode;
          return false;
        }
        if (lastAdLayoutMode === mode) return false;
        lastAdLayoutMode = mode;

        scheduleActiveModeReload(0);
        return true;
      }

      function getCurrentModeTargetIds() {
        return isPortraitBottomOnlyMode() ? ['mobileBottomAdSlot'] : SIDE_SLOT_IDS;
      }

      function resetCurrentModeSlots() {
        getCurrentModeTargetIds().forEach(resetSlotContainer);
      }

      function scheduleActiveModeReload(delayMs) {
        if (activeModeReloadTimer !== null) {
          window.clearTimeout(activeModeReloadTimer);
        }
        activeModeReloadTimer = window.setTimeout(() => {
          activeModeReloadTimer = null;
          resetCurrentModeSlots();
          queueAllSlotsOnce();
          [140, 360, 760].forEach((delay) => {
            window.setTimeout(queueAllSlotsOnce, delay);
          });
        }, Math.max(0, Number(delayMs) || 0));
      }

      function getSideAdFrameSize(container) {
        if (!(container instanceof HTMLElement)) {
          return { width: 160, height: 110 };
        }
        let mountWidth = 0;
        try {
          const host = container.closest('.panel-ad') || container.parentElement || container;
          const hostRect = host && host.getBoundingClientRect ? host.getBoundingClientRect() : null;
          mountWidth = Math.round((hostRect && hostRect.width) || 0);
        } catch (error) {
          mountWidth = 0;
        }
        if (!Number.isFinite(mountWidth) || mountWidth <= 0) {
          mountWidth = Math.round(getContainerWidth(container));
        }
        const width = clamp(mountWidth, 140, 280);
        const rawHeight = clamp(Math.round(width * 0.62), 84, 164);
        // Keep ads landscape-friendly: never allow portrait/tall aspect.
        const height = Math.min(rawHeight, Math.max(84, width - 8));
        return { width, height };
      }

      function applySideSlotGeometry(container) {
        if (!(container instanceof HTMLElement) || isMobileBottomSlot(container)) return;
        const frame = getSideAdFrameSize(container);
        const widthPx = `${frame.width}px`;
        const heightPx = `${frame.height}px`;
        container.style.setProperty('--panel-ad-width', widthPx);
        container.style.setProperty('--panel-ad-height', heightPx);
        container.style.width = widthPx;
        container.style.minWidth = widthPx;
        container.style.maxWidth = widthPx;
        container.style.height = heightPx;
        container.style.minHeight = heightPx;
        container.style.maxHeight = heightPx;
        container.style.marginLeft = 'auto';
        container.style.marginRight = 'auto';
      }

      function queueAllSlots() {
        if (handleAdLayoutTransition()) {
          return;
        }
        const portraitBottomOnly = isPortraitBottomOnlyMode();
        const targetContainerIds = portraitBottomOnly ? ['mobileBottomAdSlot'] : SIDE_SLOT_IDS;
        targetContainerIds.forEach((containerId) => {
          queueRenderForContainer(document.getElementById(containerId));
        });
      }

      function queueAllSlotsOnce() {
        if (rerenderQueued) return;
        rerenderQueued = true;
        window.requestAnimationFrame(() => {
          rerenderQueued = false;
          queueAllSlots();
        });
      }

      function isMobileBottomSlot(container) {
        if (!(container instanceof HTMLElement)) return false;
        if (container.id === 'mobileBottomAdSlot') return true;
        return Boolean(container.closest && container.closest('#mobileBottomAd'));
      }

      function getSideSlotId(container) {
        if (!(container instanceof HTMLElement)) return '';
        if (container.id === 'leftPanelAdSlot') return 'left';
        if (container.id === 'rightPanelAdSlot') return 'right';
        return '';
      }

      function isSideRailExpanded(container) {
        const side = getSideSlotId(container);
        if (!side) return true;
        const railId = side === 'left' ? 'leftRail' : 'rightRail';
        const rail = document.getElementById(railId);
        if (!(rail instanceof HTMLElement)) return true;
        if (rail.dataset.collapsed === 'true') return false;
        // Match request: left side ad only starts after the rail is widened (non-compact).
        if (side === 'left' && rail.dataset.compact === 'true') return false;
        return true;
      }

      function getContainerWidth(container) {
        if (!(container instanceof HTMLElement)) return 0;
        try {
          const rect = container.getBoundingClientRect();
          return (rect && rect.width) || container.clientWidth || container.offsetWidth || 0;
        } catch (error) {
          return container.clientWidth || container.offsetWidth || 0;
        }
      }

      function getRequiredWidth(container) {
        return isMobileBottomSlot(container) ? 1 : MIN_SIDE_AD_WIDTH;
      }

      function isContainerRenderable(container) {
        if (!(container instanceof HTMLElement) || !container.isConnected) return false;
        const width = getContainerWidth(container);
        if (width < getRequiredWidth(container)) return false;
        if (container.getClientRects && container.getClientRects().length === 0) return false;
        return true;
      }

      function hasRendered(ins) {
        if (!(ins instanceof HTMLElement)) return false;
        if (ins.dataset && ins.dataset.pixiedRendered === '1') return true;
        return ins.getAttribute('data-adsbygoogle-status') === 'done';
      }

      function getOrCreateIns(container, slot) {
        if (!(container instanceof HTMLElement)) return null;
        let ins = container.querySelector('ins');
        if (!(ins instanceof HTMLElement)) {
          ins = document.createElement('ins');
          ins.className = 'ad-seed';
          ins.style.display = 'block';
          container.appendChild(ins);
        }

        ins.style.display = 'block';
        if (!ins.classList.contains('adsbygoogle') && !ins.classList.contains('ad-seed')) {
          ins.classList.add('ad-seed');
        }
        ins.setAttribute('data-ad-client', ADS_CLIENT);
        ins.setAttribute('data-ad-slot', slot);
        if (isMobileBottomSlot(container)) {
          ins.style.removeProperty('width');
          ins.style.removeProperty('height');
          ins.style.removeProperty('min-height');
          ins.style.removeProperty('max-height');
          ins.setAttribute('data-ad-format', 'horizontal');
          ins.removeAttribute('data-full-width-responsive');
        } else {
          const sideFrame = getSideAdFrameSize(container);
          container.style.setProperty('--panel-ad-width', `${sideFrame.width}px`);
          container.style.setProperty('--panel-ad-height', `${sideFrame.height}px`);
          ins.style.display = 'block';
          ins.style.width = '100%';
          ins.style.maxWidth = '100%';
          ins.style.height = `${sideFrame.height}px`;
          ins.style.minHeight = `${sideFrame.height}px`;
          ins.style.maxHeight = `${sideFrame.height}px`;
          ins.setAttribute('data-ad-format', 'auto');
          ins.setAttribute('data-full-width-responsive', 'true');
        }

        if (localHost) {
          ins.setAttribute('data-adtest', 'on');
        } else if (ins.hasAttribute('data-adtest')) {
          ins.removeAttribute('data-adtest');
        }

        if (hasRendered(ins)) {
          ins.dataset.pixiedRendered = '1';
        }

        return ins;
      }

      function demoteOtherPendingIns(exceptIns) {
        SLOTS.forEach(({ containerId }) => {
          const container = document.getElementById(containerId);
          if (!(container instanceof HTMLElement)) return;
          const node = container.querySelector('ins.adsbygoogle');
          if (!(node instanceof HTMLElement) || node === exceptIns) return;
          if (hasRendered(node)) return;
          node.classList.remove('adsbygoogle');
          if (!node.classList.contains('ad-seed')) {
            node.classList.add('ad-seed');
          }
        });
      }

      function promoteForRender(ins) {
        if (!(ins instanceof HTMLElement)) return;
        if (!ins.classList.contains('adsbygoogle')) {
          ins.classList.add('adsbygoogle');
        }
        ins.classList.remove('ad-seed');
        ins.dataset.pixiedRendered = '0';
      }

      function rollbackPending(ins) {
        if (!(ins instanceof HTMLElement)) return;
        if (hasRendered(ins)) return;
        ins.classList.remove('adsbygoogle');
        if (!ins.classList.contains('ad-seed')) {
          ins.classList.add('ad-seed');
        }
      }

      function tryRender(container) {
        const portraitBottomOnly = isPortraitBottomOnlyMode();
        if (portraitBottomOnly && !isMobileBottomSlot(container)) return false;
        if (!portraitBottomOnly && isMobileBottomSlot(container)) return false;
        if (!isSideRailExpanded(container)) return false;
        applySideSlotGeometry(container);
        if (!isContainerRenderable(container)) return false;
        if (!isMobileBottomSlot(container) && getSideAdFrameSize(container).width < MIN_SIDE_AD_WIDTH) {
          return false;
        }
        const slotConfig = slotByContainerId.get(container.id);
        if (!slotConfig) return false;
        const ins = getOrCreateIns(container, slotConfig.slot);
        if (!(ins instanceof HTMLElement)) return false;
        if (hasRendered(ins)) return true;

        demoteOtherPendingIns(ins);
        promoteForRender(ins);

        try {
          console.debug('[pixiedraw] calling (adsbygoogle).push for', container.id, 'width=', Math.round(getContainerWidth(container)));
          (window.adsbygoogle = window.adsbygoogle || []).push({});
          ins.dataset.pixiedRendered = '1';
          return true;
        } catch (error) {
          rollbackPending(ins);
          console.warn('[pixiedraw] adsbygoogle push failed', container.id, error && error.message);
          return false;
        }
      }

      function ensureContainerObserver(container) {
        if (!(container instanceof HTMLElement)) return;
        if (resizeObserverByContainer.has(container)) return;
        if (typeof ResizeObserver !== 'function') return;
        const observer = new ResizeObserver(() => {
          applySideSlotGeometry(container);
          if (isContainerRenderable(container)) {
            tryRender(container);
          }
        });
        observer.observe(container);
        resizeObserverByContainer.set(container, observer);
      }

      function queueRenderForContainer(container) {
        if (!(container instanceof HTMLElement)) return;
        const portraitBottomOnly = isPortraitBottomOnlyMode();
        if (portraitBottomOnly && container.id !== 'mobileBottomAdSlot') {
          return;
        }
        if (!portraitBottomOnly && container.id === 'mobileBottomAdSlot') {
          return;
        }
        const slotConfig = slotByContainerId.get(container.id);
        if (!slotConfig) return;
        if (!isSideRailExpanded(container)) {
          container.dataset.pixiedRetryLoop = '0';
          return;
        }

        applySideSlotGeometry(container);
        getOrCreateIns(container, slotConfig.slot);
        ensureContainerObserver(container);
        if (tryRender(container)) return;

        if (container.dataset.pixiedRetryLoop === '1') return;
        container.dataset.pixiedRetryLoop = '1';
        let attempts = 0;

        const retry = () => {
          if (!(container instanceof HTMLElement) || !container.isConnected) {
            container.dataset.pixiedRetryLoop = '0';
            return;
          }
          if (tryRender(container)) {
            container.dataset.pixiedRetryLoop = '0';
            return;
          }
          attempts += 1;
          if (attempts < RETRY_FRAMES) {
            window.requestAnimationFrame(retry);
            return;
          }
          container.dataset.pixiedRetryLoop = '0';
        };

        window.requestAnimationFrame(retry);
      }

      queueAllSlots();
      window.addEventListener('resize', queueAllSlotsOnce, { passive: true });
      window.addEventListener('orientationchange', () => {
        scheduleActiveModeReload(40);
      }, { passive: true });
      document.addEventListener('pixiedraw:panel-ad-dock-change', queueAllSlotsOnce);
      document.addEventListener('pixiedraw:ad-layout-change', (event) => {
        const reason = event && event.detail ? String(event.detail.reason || '') : '';
        if (reason === 'resize' || reason === 'refreshListeners') {
          queueAllSlotsOnce();
          return;
        }
        scheduleActiveModeReload(24);
      });
      if (window.matchMedia) {
        const orientationMql = window.matchMedia('(orientation: portrait)');
        if (typeof orientationMql.addEventListener === 'function') {
          orientationMql.addEventListener('change', () => {
            scheduleActiveModeReload(24);
          });
        } else if (typeof orientationMql.addListener === 'function') {
          orientationMql.addListener(() => {
            scheduleActiveModeReload(24);
          });
        }
      }
      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
          queueAllSlotsOnce();
        }
      });

      const observer = new MutationObserver(queueAllSlotsOnce);
      observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'hidden', 'style', 'aria-hidden', 'data-compact', 'data-collapsed'],
        subtree: true
      });

      // Export dialog ad is rendered on-demand in app.js when the dialog opens.
    })();
  </script>

<script defer src="../scripts/pwa-install.js"></script>
</body>
</html>
