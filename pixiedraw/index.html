<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport"/>
<title>PiXiEEDraw（ピクシードロー）</title>
<meta content="#1f1f1f" name="theme-color"/>
<meta content="ブラウザで動作するピクセルアートエディター PiXiEEDraw（ピクシードロー）" name="description"/>
<meta content="PiXiEEDraw,ピクシードロー,PiXiEED,ピクシード,ドット絵エディター,ピクセルアート" name="keywords"/>
<meta content="index,follow" name="robots"/>
<meta content="website" property="og:type"/>
<meta content="PiXiEEDraw（ピクシードロー）" property="og:title"/>
<meta content="ブラウザから直接操作できるピクセルアートエディター PiXiEEDraw（ピクシードロー）" property="og:description"/>
<meta content="https://pixieed.jp/pixiedraw/ogp-app.png" property="og:image"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="PiXiEEDraw（ピクシードロー）" name="twitter:title"/>
<meta content="ブラウザから直接操作できるピクセルアートエディター PiXiEEDraw（ピクシードロー）" name="twitter:description"/>
<meta content="https://pixieed.jp/pixiedraw/ogp-app.png" name="twitter:image"/>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9801602250480253"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SZPVXMX85G"></script>
<script>
      const GA_MEASUREMENT_ID = 'G-SZPVXMX85G';
      const GA_PAGE_PATH = '/pixiedraw/';
      const PROJECT_SLUG = 'pixiedraw';
      const PROJECT_NAME = 'PiXiEEDraw';
      const PROJECT_TYPE = 'tool';
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', GA_MEASUREMENT_ID, {
        page_path: GA_PAGE_PATH,
        page_title: document.title
      });
      gtag('event', 'project_open', {
        project_slug: PROJECT_SLUG,
        project_type: PROJECT_TYPE,
        project_name: PROJECT_NAME
      });
      gtag('event', 'project_open_pixiedraw');
    </script>



<link href="assets/css/style.css" rel="stylesheet"/>
<link rel="icon" type="image/png" sizes="192x192" href="../icon/icon-192-4.png"/>
<link rel="icon" type="image/png" sizes="512x512" href="../icon/icon-512-4.png"/>
  <style id="interaction-guard">
    * {
      -webkit-touch-callout: none;
      -webkit-user-drag: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    input,
    textarea,
    [contenteditable] {
      -webkit-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
  </style>
  <script id="interaction-guard-js">
    document.addEventListener('contextmenu', (event) => {
      event.preventDefault();
    });
    document.addEventListener('dragstart', (event) => {
      event.preventDefault();
    });
  </script>
</head>
<body>
<!-- Mobile top ad placeholder (shown on portrait / small screens instead of per-panel/bottom ads) -->
<div id="mobileTopAd" aria-hidden="true">
  <div class="mobile-ad-box">バナー広告</div>
</div>
<div class="app" id="appRoot">
<div aria-labelledby="startupScreenTitle" aria-modal="true" class="startup-screen" hidden="" id="startupScreen" role="dialog" tabindex="-1">
<div class="startup-screen__backdrop"></div>
<div class="startup-screen__content">
<div class="startup-screen__header">
<h1 class="startup-screen__title" id="startupScreenTitle">PiXiEEDraw</h1>
<p class="startup-screen__subtitle">PiXiEEDraw（ピクシードロー）でドット絵づくりをはじめよう</p>
</div>
<div class="startup-screen__actions">
<button class="button button--primary" id="startupActionNew" type="button">新規作成</button>
<button class="button" id="startupActionOpen" type="button">ファイルを開く</button>
</div>
<button class="startup-screen__link" id="startupActionSkip" type="button">編集を続ける</button>
<p class="startup-screen__hint" id="startupScreenHint">ファイルを開くと既存の自動保存先を引き継ぎます。</p>
<div class="startup-screen__recent" hidden="" id="startupRecentProjects">
<h2 class="startup-screen__recent-title">最近のプロジェクト</h2>
<div class="startup-recent-list" id="startupRecentList" role="list"></div>
</div>
</div>
</div>
<div class="mobile-topbar" hidden="" id="mobileTopBar">
<div class="mobile-topbar__inner">
<div aria-label="モバイル操作パネル" class="mobile-tabs" role="tablist">
<button aria-controls="mobilePanelTools" aria-label="ツール" aria-selected="true" class="mobile-tab is-active" data-mobile-tab="tools" id="mobileTabTools" role="tab" type="button">
<span class="tab-icon-container" id="mobileToolTabIcon"></span>
<span class="sr-only">ツール</span>
</button>
<button aria-controls="mobilePanelColor" aria-label="カラー" aria-selected="false" class="mobile-tab" data-mobile-tab="color" id="mobileTabColor" role="tab" tabindex="-1" type="button">
<span class="tab-swatch pixel-frame" id="mobileColorTabSwatch"></span>
<span class="sr-only">カラー</span>
</button>
<button aria-controls="mobilePanelFrames" aria-label="フレームとレイヤー" aria-selected="false" class="mobile-tab" data-mobile-tab="frames" id="mobileTabFrames" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-frame.png"/>
<span class="sr-only">フレームとレイヤー</span>
</button>
<button aria-controls="mobilePanelSettings" aria-label="設定" aria-selected="false" class="mobile-tab" data-mobile-tab="settings" id="mobileTabSettings" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-settings.svg"/>
<span class="sr-only">設定</span>
</button>
<button aria-controls="mobilePanelFile" aria-label="ファイル" aria-selected="false" class="mobile-tab" data-mobile-tab="file" id="mobileTabFile" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-file.svg"/>
<span class="sr-only">ファイル</span>
</button>
<button aria-controls="mobilePanelPixfind" aria-label="PiXFiND" aria-selected="false" class="mobile-tab" data-mobile-tab="pixfind" id="mobileTabPixfind" role="tab" tabindex="-1" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-pixfind.png"/>
<span class="sr-only">PiXFiND</span>
</button>
</div>
<div aria-label="モバイルショートカット" class="mobile-shortcuts" id="mobileShortcutsMount">
</div>
</div>
</div>
<div class="layout" id="appLayout">
<aside aria-label="ツールとカラー設定" class="rail rail--left" data-collapsed="false" data-compact="true" id="leftRail">
<div aria-label="左パネル切替" class="rail-tabs" id="leftRailTabs" role="tablist">
<button aria-controls="panelTools" aria-label="ツール" aria-selected="true" class="rail-tab is-active" data-left-tab="tools" role="tab" title="ツール" type="button">
<span class="tab-icon-container" id="toolTabIcon"></span>
<span class="sr-only">ツール</span>
</button>
<button aria-controls="panelColor" aria-label="カラー" aria-selected="false" class="rail-tab" data-left-tab="color" id="leftTabColorButton" role="tab" tabindex="-1" title="カラー" type="button">
<span class="tab-swatch pixel-frame" id="colorTabSwatch"></span>
<span class="sr-only">カラー</span>
</button>
</div>
<div class="rail-tabpanes" id="leftRailPanes"></div>
  <div class="rail-ad" id="leftRailAd" aria-hidden="false">
    <!-- ad placeholder: replace with ad code (ins / iframe) -->
    <div class="ad-box">バナー広告</div>
  </div>
<button aria-label="左パネルの幅を変更" class="rail-resizer rail-resizer--left" id="resizeLeftRail" type="button"></button>
</aside>
<main aria-label="ドットキャンバス" class="stage" id="stage">
<div class="stage__canvas" id="canvasViewport">
<div aria-live="off" class="canvas-stack" id="canvasStack">
<canvas aria-label="描画キャンバス" height="32" id="drawingCanvas" width="32"></canvas>
<canvas aria-hidden="true" height="32" id="overlayCanvas" width="32"></canvas>
<canvas aria-hidden="true" height="32" id="selectionCanvas" width="32"></canvas>
</div>
<canvas aria-hidden="true" class="virtual-cursor-canvas" height="0" id="virtualCursorCanvas" width="0"></canvas>
<div class="canvas-controls">
<div aria-label="履歴操作" class="canvas-controls__history" role="group">
<button aria-label="元に戻す" class="chip" disabled="" id="undoAction" type="button"></button>
<button aria-label="やり直す" class="chip" disabled="" id="redoAction" type="button"></button>
</div>
</div>
<div aria-hidden="true" aria-live="polite" class="zoom-indicator" id="zoomIndicator" role="status"></div>
</div>
</main>
<aside aria-label="フレーム、レイヤー、設定、ファイル、PiXFiND" class="rail rail--right" data-collapsed="false" data-compact="true" id="rightRail">
<div aria-label="右パネル切り替え" class="rail-tabs" id="rightRailTabs" role="tablist">
<button aria-controls="panelFrames" aria-label="フレームとレイヤー" aria-selected="true" class="rail-tab is-active" data-right-tab="frames" role="tab" title="フレームとレイヤー" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-frame.png"/>
<span class="sr-only">フレームとレイヤー</span>
</button>
<button aria-controls="panelSettings" aria-label="設定" aria-selected="false" class="rail-tab" data-right-tab="settings" role="tab" tabindex="-1" title="設定" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-settings.svg"/>
<span class="sr-only">設定</span>
</button>
<button aria-controls="panelFile" aria-label="ファイル" aria-selected="false" class="rail-tab" data-right-tab="file" role="tab" tabindex="-1" title="ファイル" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-file.svg"/>
<span class="sr-only">ファイル</span>
</button>
<button aria-controls="panelPixfind" aria-label="PiXFiND" aria-selected="false" class="rail-tab" data-right-tab="pixfind" role="tab" tabindex="-1" title="PiXFiND" type="button">
<img alt="" class="tab-icon" src="assets/icons/menu-pixfind.png"/>
<span class="sr-only">PiXFiND</span>
</button>
</div>
<div class="rail-tabpanes" id="rightRailPanes"></div>
  <div class="rail-ad" id="rightRailAd" aria-hidden="false">
    <!-- ad placeholder: replace with ad code (ins / iframe) -->
    <div class="ad-box">バナー広告</div>
  </div>
<button aria-label="右パネルの幅を変更" class="rail-resizer rail-resizer--right" id="resizeRightRail" type="button"></button>
</aside>
</div>
<button aria-label="描画ボタン" class="floating-draw-button" id="floatingDrawButton" type="button">描画</button>
<div class="mobile-drawer" hidden="" id="mobileDrawer">
<button aria-label="モバイルパネルの高さを調整" aria-controls="mobilePanels" class="mobile-drawer__handle" id="mobileDrawerHandle" type="button">
<span aria-hidden="true" class="mobile-drawer__grip"></span>
</button>
<div class="mobile-panels" id="mobilePanels">
<div aria-labelledby="mobileTabTools" class="mobile-panel is-active" id="mobilePanelTools" role="tabpanel"></div>
<div aria-labelledby="mobileTabColor" class="mobile-panel" hidden="" id="mobilePanelColor" role="tabpanel"></div>
<div aria-labelledby="mobileTabFrames" class="mobile-panel" hidden="" id="mobilePanelFrames" role="tabpanel"></div>
<div aria-labelledby="mobileTabSettings" class="mobile-panel" hidden="" id="mobilePanelSettings" role="tabpanel"></div>
<div aria-labelledby="mobileTabFile" class="mobile-panel" hidden="" id="mobilePanelFile" role="tabpanel"></div>
<div aria-labelledby="mobileTabPixfind" class="mobile-panel" hidden="" id="mobilePanelPixfind" role="tabpanel"></div>
</div>
</div>
<section class="panel-section" data-section="tools" id="panelTools">
<div class="panel-section__body">
<div aria-label="ツールカテゴリ" class="tool-group-tabs" role="tablist">
<button aria-selected="true" class="tool-group-button is-active" data-tool-group="selection" role="tab" title="範囲選択" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-select-rect.svg" width="20"/>
<span class="tool-group-label">範囲選択</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="pen" role="tab" title="ペン" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-pen-new.svg" width="20"/>
<span class="tool-group-label">ペン</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="eraser" role="tab" title="消しゴム" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-eraser.png" width="20"/>
<span class="tool-group-label">消しゴム</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="shape" role="tab" title="図形" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-rect.svg" width="20"/>
<span class="tool-group-label">図形</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="fill" role="tab" title="塗りつぶし" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-fill.png" width="20"/>
<span class="tool-group-label">塗りつぶし</span>
</button>
<button aria-selected="false" class="tool-group-button" data-tool-group="virtualCursor" role="tab" title="仮想カーソル" type="button">
<img alt="" aria-hidden="true" class="tool-group-icon" height="20" src="assets/icons/tool-cursor.png" width="20"/>
<span class="tool-group-label">仮想カーソル</span>
</button>
</div>
<div aria-label="描画ツール" class="tool-grid" id="toolGrid" role="toolbar">
<button aria-pressed="true" class="tool-button is-active" data-tool="pen" data-tool-group="pen" type="button">
<img alt="ペン" height="32" src="assets/icons/tool-pen-new.svg" width="32"/>
<span>ペン</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="eyedropper" data-tool-group="pen" type="button">
<img alt="スポイト" height="32" src="assets/icons/tool-eyedropper.png" width="32"/>
<span>スポイト</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="eraser" data-tool-group="eraser" type="button">
<img alt="消しゴム" height="32" src="assets/icons/tool-eraser.png" width="32"/>
<span>消しゴム</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="line" data-tool-group="shape" type="button">
<img alt="直線" height="32" src="assets/icons/tool-line.svg" width="32"/>
<span>直線</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="curve" data-tool-group="shape" type="button">
<img alt="曲線" height="32" src="assets/icons/tool-curve.svg" width="32"/>
<span>曲線</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="rect" data-tool-group="shape" type="button">
<img alt="四角" height="32" src="assets/icons/tool-rect.svg" width="32"/>
<span>四角</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="rectFill" data-tool-group="shape" type="button">
<img alt="塗り四角" height="32" src="assets/icons/tool-rect-fill.svg" width="32"/>
<span>塗り四角</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="ellipse" data-tool-group="shape" type="button">
<img alt="丸" height="32" src="assets/icons/tool-ellipse.svg" width="32"/>
<span>丸</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="ellipseFill" data-tool-group="shape" type="button">
<img alt="塗り丸" height="32" src="assets/icons/tool-ellipse-fill.svg" width="32"/>
<span>塗り丸</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="fill" data-tool-group="fill" type="button">
<img alt="塗りつぶし" height="32" src="assets/icons/tool-fill.png" width="32"/>
<span>塗りつぶし</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="move" data-tool-group="selection" type="button">
<img alt="移動" height="32" src="assets/icons/tool-pan.svg" width="32"/>
<span>移動</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectRect" data-tool-group="selection" type="button">
<img alt="矩形選択" height="32" src="assets/icons/tool-select-rect.svg" width="32"/>
<span>矩形選択</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectLasso" data-tool-group="selection" type="button">
<img alt="投げ縄" height="32" src="assets/icons/tool-select-lasso.svg" width="32"/>
<span>投げ縄</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="selectSame" data-tool-group="selection" type="button">
<img alt="同色選択" height="32" src="assets/icons/tool-select-magic.svg" width="32"/>
<span>同色</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="virtualCursorToggle" data-tool-group="virtualCursor" type="button">
<img alt="仮想カーソル" height="32" src="assets/icons/tool-cursor.png" width="32"/>
<span>仮想表示</span>
</button>
<button aria-pressed="false" class="tool-button" data-tool="virtualCursorCenter" data-tool-group="virtualCursor" type="button">
<img alt="仮想カーソル中央" height="32" src="assets/icons/tool-pan.svg" width="32"/>
<span>中央へ</span>
</button>
</div>
<div class="field-group">
<label class="field">
<span>ブラシサイズ</span>
<input id="brushSize" max="12" min="1" type="range" value="1"/>
<output for="brushSize" id="brushSizeValue">1px</output>
</label>
</div>
</div>
</section>
<section class="panel-section" data-section="color" id="panelColor">
<div class="panel-section__body">
<div class="color-mode color-mode--index" id="colorModeIndex">
<div class="palette-header">
<div class="palette-actions">
<button aria-label="選択した色を削除" class="chip" id="removePaletteColor" type="button">-</button>
<button aria-label="色を追加" class="chip" id="addPaletteColor" type="button">+</button>
</div>
</div>
<div aria-label="カラーパレット" class="palette-grid" id="paletteList" role="listbox"></div>
<div class="palette-editor" id="paletteEditor">
<label class="field field--compact">
<span>インデックス</span>
<input data-stepper="true" id="paletteIndex" min="0" step="1" type="number"/>
</label>
<div class="palette-hsv" id="paletteHsvControls">
<div class="palette-wheel" id="paletteWheelWrapper">
<canvas aria-label="色相環" height="220" id="paletteColorWheel" width="220"></canvas>
<div class="palette-wheel__cursor" id="paletteWheelCursor"></div>
</div>
<div class="palette-sliders">
<div aria-hidden="true" class="palette-preview" id="palettePreview"></div>
<label class="field field--compact">
<span>色相</span>
<input id="paletteHue" max="360" min="0" type="range" value="0"/>
</label>
<label class="field field--compact">
<span>彩度</span>
<input id="paletteSaturation" max="100" min="0" type="range" value="0"/>
</label>
<label class="field field--compact">
<span>明度</span>
<input id="paletteValue" max="100" min="0" type="range" value="100"/>
</label>
<label class="field field--compact palette-alpha-field">
<span>アルファ</span>
<input id="paletteAlphaSlider" max="255" min="0" type="range" value="255"/>
<output for="paletteAlphaSlider" id="paletteAlphaValue">255</output>
</label>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="panel-section" data-section="frames" id="panelFrames">
<div class="panel-section__body">
<div aria-label="レイヤーとフレームのタイムライン" class="timeline-card" role="group">
<div class="timeline-toolbar">
<div aria-label="レイヤー操作" class="timeline-toolbar__group timeline-toolbar__group--layer" role="group">
<button aria-label="レイヤーを追加" class="pixel-button pixel-frame" id="addLayer" type="button">＋</button>
<button aria-label="レイヤーを削除" class="pixel-button pixel-frame" id="removeLayer" type="button">－</button>
<button aria-label="選択中のレイヤーを上に移動" class="pixel-button pixel-frame" id="moveLayerUp" type="button">▼</button>
<button aria-label="選択中のレイヤーを下に移動" class="pixel-button pixel-frame" id="moveLayerDown" type="button">▲</button>
<span class="timeline-toolbar__label">レイヤー</span>
</div>
<div aria-label="フレーム操作" class="timeline-toolbar__group timeline-toolbar__group--frame" role="group">
<button aria-label="フレームを追加" class="pixel-button pixel-frame" id="addFrame" type="button">＋</button>
<button aria-label="フレームを削除" class="pixel-button pixel-frame" id="removeFrame" type="button">－</button>
<button aria-label="選択中のフレームを左に移動" class="pixel-button pixel-frame" id="moveFrameUp" type="button">◀</button>
<button aria-label="選択中のフレームを右に移動" class="pixel-button pixel-frame" id="moveFrameDown" type="button">▶</button>
<span class="timeline-toolbar__label">フレーム</span>
</div>
</div>
<div class="timeline-matrix-wrapper">
<div aria-label="フレームとレイヤーの一覧" class="timeline-matrix" id="timelineMatrix" role="grid"></div>
</div>
<div class="timeline-footer">
<div aria-label="再生ボタン群" class="timeline-playback" role="group">
<button aria-label="最初のフレームへ" class="pixel-button pixel-frame" id="rewindAnimation" type="button">⏮</button>
<button aria-label="再生" class="pixel-button pixel-frame" id="playAnimation" type="button">▶</button>
<button aria-label="停止" class="pixel-button pixel-frame" id="stopAnimation" type="button">■</button>
<button aria-label="次のフレームへ" class="pixel-button pixel-frame" id="forwardAnimation" type="button">⏭</button>
</div>
<div aria-label="フレームレート設定" class="timeline-fps" role="group">
<label class="field field--tiny timeline-fps-control">
<span>fps</span>
<input data-stepper="true" id="animationFps" max="60" min="1" type="number" value="12"/>
</label>
<span class="timeline-fps-hint" id="animationFpsMs">83ms</span>
<button aria-label="全フレームに現在の fps を適用" class="chip" id="applyFpsAll" type="button">全体適用</button>
</div>
</div>
</div>
</div>
</section>
<section class="panel-section" data-section="file" id="panelFile">
<div class="panel-section__body">
<div class="field-group">
<button class="button" id="newProject" type="button">新規作成</button>
<button class="button" id="openDocument" type="button">ファイルを開く</button>
<button class="button" id="exportProject" type="button">出力</button>
<p class="help-text">出力: PNG/GIF/コンテスト投稿/プロジェクト保存をまとめています。</p>
<button class="button" id="clearCanvas" type="button">キャンバスをクリア</button>
<button class="button" id="enableAutosave" type="button">ローカルに自動保存</button>
<p class="help-text">自動保存はこの端末内に下書きを保存します。出力は共有・配布用です。</p>
</div>
<p aria-live="polite" class="help-text" id="autosaveStatus"></p>
<div aria-live="polite" class="field memory-control" role="status">
<span id="memoryUsage">メモリ: 計測中…</span>
<button class="chip" id="memoryClear" type="button">メモリ削除</button>
</div>
</div>
</section>
<section class="panel-section" data-section="pixfind" id="panelPixfind">
<div class="panel-section__body">
<div class="field-group">
<button aria-pressed="false" class="button" id="togglePixfindMode" type="button">PiXFiNDモード: OFF</button>
<button class="button" disabled="" id="sendToPixfind" type="button">PiXFiNDへ送る</button>
<p aria-live="polite" class="help-text" id="pixfindActionReason"></p>
<p class="help-text">PiXFiNDモードON時は「フレーム1=原本」「フレーム2=差分」で送信します。ONにするたびフレーム2はフレーム1から作り直されます。</p>
</div>
</div>
</section>
<section class="panel-section" data-section="settings" id="panelSettings">
<div class="panel-section__body">
  <div class="settings-nav">
    <a class="button" href="/index.html" id="goHomeButton">PiXiEEDホームへ戻る</a>
  </div>
<label class="field settings-size-row settings-size-row--canvas">
<span>キャンバスサイズ</span>
<div class="field field--inline settings-size-controls">
<label class="field field--tiny">
<span>横</span>
<input data-stepper="true" id="canvasWidth" max="512" min="1" type="number" value="32"/>
</label>
<label class="field field--tiny">
<span>縦</span>
<input data-stepper="true" id="canvasHeight" max="512" min="1" type="number" value="32"/>
</label>
</div>
</label>
<label class="field settings-size-row settings-size-row--sprite">
<span>スプライト倍率</span>
<div class="field field--inline settings-size-controls">
<label class="field field--tiny">
<span>倍率</span>
<input data-stepper="true" id="spriteScaleInput" inputmode="numeric" min="1" step="1" type="number" value="1"/>
</label>
<button class="button" disabled="" id="applySpriteScale" type="button">倍率を適用</button>
</div>
<p class="help-text">キャンバスと描画済みのピクセルを整数倍で拡大します。</p>
</label>
<label class="field">
<span>ズーム</span>
<input id="zoomSlider" max="40" min="1" type="range" value="8"/>
</label>
<div aria-label="表示設定" class="field field--list" role="group">
<ul class="toggle-list">
<li>
<label class="toggle-option" for="toggleGrid">
<input checked="" id="toggleGrid" type="checkbox"/>
<span>グリッド</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleMajorGrid">
<input id="toggleMajorGrid" type="checkbox"/>
<span>メジャー</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleChecker">
<input checked="" id="toggleChecker" type="checkbox"/>
<span>16px グレーチェック</span>
</label>
</li>
<li>
<label class="toggle-option" for="togglePixelPreview">
<input checked="" id="togglePixelPreview" type="checkbox"/>
<span>1px ガイド</span>
</label>
</li>
<li>
<label class="toggle-option" for="toggleVirtualCursor">
<input id="toggleVirtualCursor" type="checkbox"/>
<span>仮想カーソル</span>
</label>
</li>
</ul>
<div class="virtual-cursor-scale">
<label class="virtual-cursor-scale__control" for="virtualCursorButtonScale">
<span class="virtual-cursor-scale__label">仮想カーソルボタンサイズ</span>
<input id="virtualCursorButtonScale" list="virtualCursorButtonScaleMarks" max="2" min="1" step="0.5" type="range" value="2"/>
</label>
<div class="virtual-cursor-scale__meta">
<div aria-hidden="true" class="virtual-cursor-scale__ticks">
<span>1×</span>
<span>1.5×</span>
<span>2×</span>
</div>
<output class="virtual-cursor-scale__value" for="virtualCursorButtonScale" id="virtualCursorButtonScaleValue">2×</output>
</div>
<datalist id="virtualCursorButtonScaleMarks">
<option label="1×" value="1"></option>
<option label="1.5×" value="1.5"></option>
<option label="2×" value="2"></option>
</datalist>
</div>
<button aria-pressed="false" class="chip" id="toggleBackgroundMode" type="button">背景</button>
</div>
</div>
</section>
</div>
<dialog aria-labelledby="exportDialogTitle" class="modal" id="exportDialog">
<form class="modal__form" id="exportDialogForm" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="exportDialogTitle">出力形式</h2>
</header>
<div class="modal__body">
<div class="field field--list">
<span>出力倍率</span>
<div class="scale-controls">
<div class="scale-control scale-control--wide">
<label for="exportScaleSlider">倍率 (×)</label>
<input id="exportScaleSlider" max="1" min="1" step="1" type="range" value="1"/>
<input data-stepper="true" id="exportScaleInput" inputmode="numeric" min="1" type="number" value="1"/>
</div>
</div>
<p class="help-text" id="exportScaleHint"></p>
<label class="toggle-option export-original-toggle" for="exportIncludeOriginalToggle">
<input id="exportIncludeOriginalToggle" type="checkbox"/>
<span>拡大出力時に原寸も追加で出力する</span>
</label>
</div>
<div class="field field--list">
<div aria-live="polite" class="export-guidance">
<p class="help-text"><strong>iPhoneで保存</strong> 共有 → ファイルに保存</p>
<p class="help-text"><strong>Androidで保存</strong> 保存</p>
</div>
<div aria-label="出力形式の選択" class="export-actions" role="group">
<label class="field field--compact">
<span>形式</span>
<select id="exportFormat">
<option value="png">PNG（画像）</option>
<option value="gif">GIF（アニメーション）</option>
<option value="contest">コンテストに投稿</option>
<option value="pixfind">PiXFiNDへ送る</option>
<option value="project">プロジェクト（.pixieedraw）</option>
</select>
</label>
<button class="button button--primary" id="confirmExport" type="button">出力</button>
</div>
</div>
<div aria-label="広告" class="export-ad" id="exportAdContainer">
<div class="export-ad__slot">
<ins class="adsbygoogle" data-ad-client="ca-pub-9801602250480253" data-ad-format="auto" data-ad-slot="2141591954" data-full-width-responsive="true" id="exportAdSlot" style="display:block"></ins>
</div>
<small class="export-ad__label">広告</small>
</div>
</div>
<footer class="modal__footer">
<button class="button button--ghost" id="cancelExport" type="button">キャンセル</button>
</footer>
</form>
</dialog>
<dialog aria-labelledby="newProjectTitle" class="modal" id="newProjectDialog">
<form class="modal__form" id="newProjectForm" method="dialog">
<header class="modal__header">
<h2 class="modal__title" id="newProjectTitle">新規プロジェクト</h2>
</header>
<div class="modal__body">
<label class="field new-project__name-field">
<span>ファイル名</span>
<div class="new-project__name-input">
<input id="newProjectName" maxlength="109" placeholder="example" required="" type="text"/>
<span aria-hidden="true" class="new-project__name-suffix">.pixieedraw</span>
</div>
<p class="help-text">ファイル名のみ入力してください。拡張子 .pixieedraw は自動で付きます。</p>
</label>
<div class="field field--inline new-project__size-fields">
<span>キャンバスサイズ</span>
<div class="new-project__size-inputs">
<label class="field field--tiny">
<span>横</span>
<input data-stepper="true" id="newProjectWidth" max="512" min="1" required="" type="number" value="32"/>
</label>
<label class="field field--tiny">
<span>縦</span>
<input data-stepper="true" id="newProjectHeight" max="512" min="1" required="" type="number" value="32"/>
</label>
</div>
</div>
</div>
<footer class="modal__footer">
<button class="button button--ghost" id="cancelNewProject" type="button">キャンセル</button>
<button class="button button--primary" id="confirmNewProject" type="submit">作成</button>
</footer>
</form>
</dialog>
<script>
      (function preventBrowserZoom() {
        const blockedKeys = new Set(['=', '+', '-', '_', '0']);
        const blockedCodes = new Set(['Equal', 'Minus', 'Digit0', 'NumpadAdd', 'NumpadSubtract', 'Numpad0']);

        document.addEventListener('keydown', (event) => {
          if (!(event.ctrlKey || event.metaKey)) return;
          if (blockedKeys.has(event.key) || blockedCodes.has(event.code)) {
            event.preventDefault();
            event.stopPropagation();
          }
        });

        window.addEventListener(
          'wheel',
          (event) => {
            if (event.ctrlKey) {
              event.preventDefault();
            }
          },
          { passive: false }
        );

        ['gesturestart', 'gesturechange', 'gestureend'].forEach((type) => {
          window.addEventListener(
            type,
            (event) => {
              event.preventDefault();
            },
            { passive: false }
          );
        });
      })();
    </script>
<script defer="" src="assets/js/app.js"></script>
</script>
  <!-- Mobile bottom ad placeholder (visible in portrait / small screens) -->
  <div id="mobileBottomAd" aria-hidden="false">
    <div class="mobile-ad-box">バナー広告</div>
  </div>
  <script>
    (function () {
      // Show mobile bottom ad when the active tool/settings panel (mobile or rail) is scrolled to bottom.
      const mobileAd = document.getElementById('mobileBottomAd');
      const mobilePanels = document.getElementById('mobilePanels');
      if (!mobileAd) return;

  const mql = window.matchMedia('(orientation: portrait)');
  const mobileTopAd = document.getElementById('mobileTopAd');
      let raf = null;
      const listeners = new Map();

      function isAtBottom(el) {
        if (!el) return false;
        if (el.scrollHeight <= el.clientHeight + 8) return false;
        const threshold = 24;
        return el.scrollTop + el.clientHeight >= el.scrollHeight - threshold;
      }

      function showAd() {
        mobileAd.classList.add('visible');
        mobileAd.setAttribute('aria-hidden', 'false');
      }

      function hideAd() {
        mobileAd.classList.remove('visible');
        mobileAd.setAttribute('aria-hidden', 'true');
      }

      function getActiveScrollableContainers() {
        const set = new Set();
        // mobile drawer active panel body
        if (mobilePanels) {
          const mobileBody = mobilePanels.querySelector('.mobile-panel.is-active .panel-section__body') || mobilePanels.querySelector('.mobile-panel.is-active');
          if (mobileBody) set.add(mobileBody);
        }
        // any active panel-section bodies (used in left/right rails)
        document.querySelectorAll('.panel-section.is-active .panel-section__body').forEach((el) => set.add(el));
        return set;
      }

      function onScrollDebounced() {
        if (raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(function () {
          const containers = getActiveScrollableContainers();
          const anyAtBottom = Array.from(containers).some(isAtBottom);

          // Top ad: show in portrait as overlay and mark body so CSS can push UI down
          if (mobileTopAd) {
            if (mql.matches) {
              mobileTopAd.classList.add('visible');
              mobileTopAd.setAttribute('aria-hidden', 'false');
              document.body.classList.add('top-ad-active');
            } else {
              mobileTopAd.classList.remove('visible');
              mobileTopAd.setAttribute('aria-hidden', 'true');
              document.body.classList.remove('top-ad-active');
            }
          }

          // Bottom ad: show only on non-portrait when panel is at bottom
          if (mql.matches) {
            // in portrait, ensure bottom ad is hidden (CSS also hides it)
            hideAd();
          } else {
            if (anyAtBottom) {
              showAd();
            } else {
              hideAd();
            }
          }

          raf = null;
        });
      }

      function refreshListeners() {
        // remove previous
        listeners.forEach((fn, el) => el.removeEventListener('scroll', fn));
        listeners.clear();
        // add new listeners
        const containers = getActiveScrollableContainers();
        containers.forEach((el) => {
          const fn = onScrollDebounced;
          el.addEventListener('scroll', fn, { passive: true });
          listeners.set(el, fn);
        });
        // immediate check
        onScrollDebounced();
      }

      // observe body for active-panel changes and refresh listeners
      const mo = new MutationObserver(refreshListeners);
      mo.observe(document.body, { attributes: true, subtree: true, childList: true });

      if (mql && typeof mql.addEventListener === 'function') {
        mql.addEventListener('change', refreshListeners);
      } else if (mql && typeof mql.addListener === 'function') {
        mql.addListener(refreshListeners);
      }
      window.addEventListener('resize', refreshListeners);
      document.addEventListener('readystatechange', function () { if (document.readyState === 'complete') refreshListeners(); });

      // inject panel-embedded ad placeholders inside every panel-section__body
      function initPanelEmbeddedAds() {
        document.querySelectorAll('.panel-section__body').forEach((body) => {
          if (body.querySelector('.panel-ad')) return; // already added
          const adWrap = document.createElement('div');
          adWrap.className = 'panel-ad';
          adWrap.setAttribute('aria-hidden', 'true');
          const box = document.createElement('div');
          box.className = 'ad-box';
          box.textContent = 'バナー広告';
          adWrap.appendChild(box);
          // append as last child so it sits visually after content but is sticky
          body.appendChild(adWrap);
        });
      }

      // initial setup
      initPanelEmbeddedAds();
      refreshListeners();
    })();
  </script>
  <script>
    // AdSense injector: insert real AdSense slots into known containers and trigger rendering.
    (function initAds() {
      if (!document || !window) return;
      // If the global adsbygoogle script is not present yet, it will still be available when loaded in <head>.
      const ADS_CLIENT = 'ca-pub-9801602250480253';
      const SLOTS = [
        { containerId: 'leftRailAd', slot: '2141591954' },
        { containerId: 'rightRailAd', slot: '9073878884' },
        { containerId: 'mobileTopAd', slot: '2261515379' }
      ];

      // localStorage key to remember when the user closed the mobile top lite banner
      const MOBILE_TOP_CLOSED_KEY = 'pixiedraw_mobile_top_ad_closed_v1';

      function ensureIns(container, slot) {
        if (!container) return false;
        // if a real ins already exists, keep it
        if (container.querySelector && container.querySelector('ins.adsbygoogle')) return true;
        if (container._pixieed_pendingIns) return true;
        // If mobile top ad has been closed by user, do not insert real ad/ins
        try {
          if (container.id === 'mobileTopAd' && localStorage.getItem(MOBILE_TOP_CLOSED_KEY) === '1') {
            console.debug('[pixiedraw] mobile top ad closed by user; skipping ins insertion');
            return false;
          }
        } catch (e) {}
        // create ins element
        const ins = document.createElement('ins');
        ins.className = 'adsbygoogle';
        ins.style.display = 'block';
        ins.setAttribute('data-ad-client', ADS_CLIENT);
        ins.setAttribute('data-ad-slot', slot);
        ins.setAttribute('data-ad-format', 'auto');
        ins.setAttribute('data-full-width-responsive', 'true');
        // enable AdSense test mode on localhost/dev so test ads can appear
        try {
          const host = (location && location.hostname) ? location.hostname : '';
          if (host === 'localhost' || host === '127.0.0.1' || host === '::1') {
            ins.setAttribute('data-adtest', 'on');
            console.info('[pixiedraw] AdSense: enabling data-adtest=on for local dev');
          }
        } catch (err) {
          // ignore
        }
        // Do not append ins immediately if the container may have zero width.
        // Store it as a pending element and append later when the container is sized.
        try {
          container._pixieed_pendingIns = ins;
          console.debug('[pixiedraw] created pending ins.adsbygoogle for', container.id || container);
        } catch (e) {
          // fallback: append immediately if we can't attach property
          container.innerHTML = '';
          container.appendChild(ins);
          console.debug('[pixiedraw] inserted ins.adsbygoogle into (fallback)', container.id || container);
        }
        return true;
      }

      function tryRender(container) {
        try {
          // Prefer the site's global lazy ad queue if present (pixieedObserveAds),
          // which handles slot assignment, queuing, and ready polling consistently across pages.
          if (window.pixieedObserveAds && typeof window.pixieedObserveAds === 'function') {
            try {
              window.pixieedObserveAds(container || document);
              console.debug('[pixiedraw] handed ad container to pixieedObserveAds', container || document);
              return;
            } catch (e) {
              console.warn('[pixiedraw] pixieedObserveAds call failed', e && e.message);
            }
          }
          console.debug('[pixiedraw] calling (adsbygoogle).push for rendering (fallback)');
          (window.adsbygoogle = window.adsbygoogle || []).push({});
        } catch (e) {
          console.warn('[pixiedraw] adsbygoogle push failed', e && e.message);
          // ignore; fallback renderer will show placeholders
        }
      }

      // Insert ins elements where needed, but only call adsbygoogle.push() when the
      // container has a measurable width. Ads will fail with "No slot size for availableWidth=0"
      // if push() is called while the container is hidden or has 0 width.
      function scheduleRenderForContainer(container) {
        if (!container) return;
        const hasWidth = () => {
          try {
            const r = container.getBoundingClientRect();
            return (r && r.width) > 0;
          } catch (e) {
            return (container.clientWidth || container.offsetWidth) > 0;
          }
        };

        if (container && container.id === 'mobileTopAd') {
          // Do not show mobile top lite banner if user previously closed it
          try {
            if (localStorage.getItem(MOBILE_TOP_CLOSED_KEY) === '1') {
              console.debug('[pixiedraw] mobile top ad closed; skipping rendering');
              return;
            }
          } catch (e) {}
        }

        if (hasWidth()) {
          // If there is a pending ins element, append it now so pixieedObserveAds / adsbygoogle can measure it.
          try {
            if (container._pixieed_pendingIns) {
              const ins = container._pixieed_pendingIns;
              container._pixieed_pendingIns = null;
              container.innerHTML = '';
              container.appendChild(ins);
              console.debug('[pixiedraw] appended pending ins into', container.id || container);
            }
          } catch (e) {}
          console.debug('[pixiedraw] container has width, rendering ads now for', container.id || container);
          tryRender(container);
          return;
        }

        // Use ResizeObserver when available to detect when the container becomes visible / sized.
        let ro = null;
        const cleanup = () => {
          try { if (ro) ro.disconnect(); } catch (e) {}
          window.removeEventListener('resize', onResize);
          document.removeEventListener('visibilitychange', onVisibility);
        };

        const onResize = () => {
          if (hasWidth()) {
            console.debug('[pixiedraw] resize observed, container sized for', container.id || container);
            tryRender();
            cleanup();
          }
        };

        const onVisibility = () => {
          if (document.visibilityState === 'visible' && hasWidth()) {
            console.debug('[pixiedraw] visibilitychange -> visible and container sized for', container.id || container);
            tryRender();
            cleanup();
          }
        };

        if (window.ResizeObserver) {
          try {
            ro = new ResizeObserver((entries) => {
              for (const entry of entries) {
                if ((entry.contentRect && entry.contentRect.width) || hasWidth()) {
                  try {
                    if (container._pixieed_pendingIns) {
                      const ins = container._pixieed_pendingIns;
                      container._pixieed_pendingIns = null;
                      container.innerHTML = '';
                      container.appendChild(ins);
                      console.debug('[pixiedraw] ResizeObserver appended pending ins into', container.id || container);
                    }
                  } catch (e) {}
                  console.debug('[pixiedraw] ResizeObserver: container now has width for', container.id || container);
                  tryRender(container);
                  cleanup();
                  return;
                }
              }
            });
            ro.observe(container);
          } catch (e) {
            // fallthrough to window resize listener
            window.addEventListener('resize', onResize);
            document.addEventListener('visibilitychange', onVisibility);
          }
        } else {
          window.addEventListener('resize', onResize);
          document.addEventListener('visibilitychange', onVisibility);
        }
      }

      // Insert ins elements and schedule rendering only when the container is sized.
      SLOTS.forEach(({ containerId, slot }) => {
        const container = document.getElementById(containerId);
        if (ensureIns(container, slot)) {
          scheduleRenderForContainer(container);
        }
      });

      // Ensure export ad slot (exists in the export dialog) is rendered when visible/sized
      const exportSlot = document.getElementById('exportAdSlot');
      if (exportSlot) {
        // exportSlot is the ins itself in this case; ensure it's assigned a slot if needed
        try {
          if (!exportSlot.getAttribute('data-ad-slot') || exportSlot.getAttribute('data-ad-slot') === 'rotate') {
            exportSlot.setAttribute('data-ad-slot', '2141591954');
          }
        } catch (e) {}
        scheduleRenderForContainer(exportSlot.parentElement || exportSlot);
      }
    })();
  </script>

  <script>
    // Fallback ad renderer: when AdSense isn't available, render rotating placeholder banners in .ad-box elements.
    (function renderFallbackAds() {
      const adBoxes = Array.from(document.querySelectorAll('.ad-box, .mobile-ad-box'));
      if (!adBoxes.length) return;

      // If adsbygoogle exists and ins.adsbygoogle are present, do not override
      if (window.adsbygoogle) {
        // let real ads initialize if ins elements already present
        const hasIns = adBoxes.some(b => !!b.querySelector('ins'));
        if (hasIns) return;
      }

      const samples = [
        { bg: '#ffd18c', text: '広告サンプルA' },
        { bg: '#b6e3ff', text: '広告サンプルB' },
        { bg: '#d3f8d3', text: '広告サンプルC' }
      ];

      adBoxes.forEach((box, idx) => {
        // Respect mobile-top-closed state for mobileTopAd
        try {
          if (box.closest && box.closest('#mobileTopAd') && localStorage.getItem('pixiedraw_mobile_top_ad_closed_v1') === '1') {
            // leave placeholder empty
            box.innerHTML = '';
            return;
          }
        } catch (e) {}

        // If this box is the mobile top ad, render PiXiEEDrawLite-style compact banner
        if (box.closest && box.closest('#mobileTopAd')) {
          box.style.overflow = 'hidden';
          box.innerHTML = '';
          const wrapper = document.createElement('div');
          wrapper.className = 'ad-lite';
          const logo = document.createElement('div');
          logo.className = 'logo';
          logo.textContent = 'PX';
          const text = document.createElement('div');
          text.className = 'text';
          text.textContent = 'PiXiEEDraw Lite — より軽く、すぐ遊べる';
          const close = document.createElement('button');
          close.className = 'ad-close';
          close.setAttribute('aria-label', '広告を閉じる');
          close.textContent = '×';
          close.addEventListener('click', () => {
            try { localStorage.setItem('pixiedraw_mobile_top_ad_closed_v1', '1'); } catch (e) {}
            const top = document.getElementById('mobileTopAd');
            if (top) {
              top.classList.remove('visible');
              top.setAttribute('aria-hidden', 'true');
              document.body.classList.remove('top-ad-active');
            }
          });
          wrapper.appendChild(logo);
          wrapper.appendChild(text);
          wrapper.appendChild(close);
          box.appendChild(wrapper);
          return;
        }

        let i = idx % samples.length;
        box.style.overflow = 'hidden';
        function render() {
          const s = samples[i % samples.length];
          box.innerHTML = '';
          const el = document.createElement('div');
          el.style.width = '100%';
          el.style.height = '100%';
          el.style.display = 'flex';
          el.style.alignItems = 'center';
          el.style.justifyContent = 'center';
          el.style.background = s.bg;
          el.style.color = '#111';
          el.style.fontWeight = '700';
          el.textContent = s.text;
          box.appendChild(el);
          i++;
        }
        render();
        setInterval(render, 5000 + (idx * 1000));
      });
    })();
  </script>
</body>
</html>
